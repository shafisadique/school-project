# # See https://docs.github.com/get-started/getting-started-with-git/ignoring-files for more about ignoring files.

# # Compiled output
# /dist
# /tmp
# /out-tsc
# /bazel-out

# # Node
# /node_modules
# npm-debug.log
# yarn-error.log

# # IDEs and editors
# .idea/
# .project
# .classpath
# .c9/
# *.launch
# .settings/
# *.sublime-workspace

# # Visual Studio Code
# .vscode/*
# !.vscode/settings.json
# !.vscode/tasks.json
# !.vscode/launch.json
# !.vscode/extensions.json
# .history/*

# # Miscellaneous
# /.angular/cache
# .sass-cache/
# /connect.lock
# /coverage
# /libpeerconnection.log
# testem.log
# /typings

# # System files
# .DS_Store
# Thumbs.db
name: Deploy SuperAdmin to Production

on:
  push:
    branches: [main, master]

jobs:
  deploy:
    runs-on: ubuntu-latest
    name: ğŸš€ Deploy to AWS
    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v3

      - name: ğŸ”§ Setup Node.js 18
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: ğŸ“¦ Install dependencies
        run: |
          npm ci
          npm install -g @angular/cli

      - name: ğŸ—ï¸ Build Angular Project
        run: |
          npm run build --prod

      - name: ğŸ“¤ Deploy to AWS Server
        uses: easingthemes/ssh-deploy@v4
        with:
          SSH_PRIVATE_KEY: ${{ secrets.AWS_SSH_KEY }}
          REMOTE_HOST: 3.110.185.234
          REMOTE_USER: ubuntu
          SOURCE: 'dist/'
          TARGET: '/var/www/superadmin/frontend/dist/'
          ARGS: "-rltgoDzvO --delete"