<ul class="list-unstyled">
  <li class="pc-h-item">
    <div class="row mb-3">
      <div class="col-md-12">
        <!-- <button class="btn btn-primary" (click)="openUpgradeModal(upgradeModal)" *ngIf="role === 'admin'">Upgrade</button> -->
      <!-- nav-right.component.html – Replace the subscription alert section only -->
<div class="subscription-alert-container" *ngIf="authService.getUserRole() === 'admin' && showExpiryAlert">
  <!-- Expiring Soon (Warning) -->
  <div class="alert alert-warning d-flex align-items-center gap-3" *ngIf="isExpiringSoon">
    <i class="bi bi-exclamation-triangle me-2"></i> <!-- Optional icon -->
    <span>{{ expiryMessage }}</span>
    <button class="btn btn-sm btn-primary ms-auto" routerLink="/subscription-plans">
      Upgrade Now
    </button>
  </div>

  <!-- Expired (Danger) -->
  <div class="alert alert-danger d-flex align-items-center gap-3" *ngIf="isExpired">
    <i class="bi bi-x-circle me-2"></i>
    <span>{{ expiryMessage }}</span>
    <button class="btn btn-sm btn-danger ms-auto" routerLink="/subscription-plans">
      Renew Now
    </button>
  </div>

  <!-- Pending (Info) -->
  <div class="alert alert-info d-flex align-items-center gap-3" *ngIf="isPending">
    <i class="bi bi-clock me-2"></i>
    <span>{{ expiryMessage }}</span>
    <button class="btn btn-sm btn-info ms-auto" routerLink="/subscription-plans">
      Check Status
    </button>
  </div>
</div>

<!-- ... rest of HTML unchanged (notifications dropdown, user profile, etc.) -->
      </div>
    </div>
  </li>

  <li class="dropdown pc-h-item" ngbDropdown>
  <a class="pc-head-link dropdown-toggle arrow-none position-relative" style="background-color: #e9ecef;" ngbDropdownToggle>
    <i antIcon type="bell" theme="outline" class="f-20"></i>
  <span 
  class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
  *ngIf="notificationCount > 0">
  <span class="visually-hidden">unread notifications</span>
  {{ notificationCount > 99 ? '99+' : notificationCount }}
</span>
  </a>

  <div class="dropdown-menu dropdown-menu-end dropdown-notification pc-h-dropdown" ngbDropdownMenu>
    <div class="dropdown-header d-flex align-items-center justify-content-between bg-light">
      <h5 class="mb-0">Notifications</h5>
      <small class="text-muted">{{ notifications.length }} total</small>
    </div>

    <ng-scrollbar class="notification-scroll" style="height: 320px">
      <div class="list-group list-group-flush">
        <a 
          href="javascript:" 
          class="list-group-item list-group-item-action border-0 px-3 py-2"
          *ngFor="let n of notifications"
          (click)="markAsRead(n._id)"
          [class.bg-light-primary]="n.status !== 'read' && n.status !== 'delivered'">

          <div class="d-flex align-items-start">
            <div class="flex-shrink-0 mt-1">
              <div class="avatar-sm bg-soft-primary rounded-circle d-flex align-items-center justify-content-center">
                <i antIcon theme="outline" [type]="
                  n.type === 'announcement' ? 'sound' :
                  n.type === 'assignment' ? 'file-text' :
                  n.type === 'progress-report' ? 'trophy' : 'bell'
                "></i>
              </div>
            </div>

            <div class="flex-grow-1 ms-3 overflow-hidden">
              <h6 class="mb-1 text-truncate" style="max-width: 220px;">
                {{ n.title }}
              </h6>
              <p class="mb-1 text-muted small text-truncate" style="max-width: 220px;">
                {{ n.message }}
              </p>
              <small class="text-muted">
                {{ n.senderId?.name || 'System' }} • {{ n.createdAt | date:'short' }}
              </small>
            </div>
          </div>
        </a>
      </div>

      <div class="text-center py-3 text-muted small" *ngIf="notifications.length === 0">
        No new notifications
      </div>
    </ng-scrollbar>

    <div class="dropdown-footer text-center py-2 bg-light">
      <a routerLink="/notifications/all" class="small link-primary">View All Notifications</a>
    </div>
  </div>
</li>
  <li class="dropdown pc-h-item header-user-profile" ngbDropdown>
    <a class="pc-head-link dropdown-toggle arrow-none me-0" ngbDropdownToggle (click)="playNotificationSound()">
      <img src="assets/images/user/avatar-2.jpg" alt="user-image" class="user-avatar me-2" />
      <span class="f-w-600">{{ username }}</span>
    </a>
    <div class="dropdown-menu dropdown-user-profile dropdown-menu-end pc-h-dropdown" ngbDropdownMenu>
      <div class="dropdown-header">
        <div class="d-flex mb-1">
          <div class="flex-shrink-0">
            <img src="assets/images/user/avatar-2.jpg" alt="user-image" class="user-avatar wid-35" />
          </div>
          <div class="flex-grow-1 ms-3 text-start">
            <h6 class="mb-0">{{ username }}</h6>
            <span>{{ role }}</span>
          </div>
          <a href="javascript:" class="bg-transparent"><i class="d-flex f-20" antIcon theme="outline" type="logout"></i></a>
        </div>
      </div>
      <ul ngbNav #nav="ngbNav" class="nav drp-tabs nav-fill nav-tabs">
        <li ngbNavItem="1">
          <a ngbNavLink>
            <i antIcon theme="outline" type="user" class="me-2"></i>
            Profile
          </a>
          <ng-template ngbNavContent>
            @for (task of filteredProfile; track task) {
              <div>
                <a class="dropdown-item" [routerLink]="task.link">
                  <i class="text-muted" antIcon theme="outline" type="{{ task.icon }}"></i>
                  <span>{{ task.title }}</span>
                </a>
              </div>
            }
            <div>
              <a class="dropdown-item" (click)="logOut()">
                <i class="text-muted" antIcon theme="outline" type="logout"></i>
                <span>Logout</span>
              </a>
            </div>
          </ng-template>
        </li>
        <li ngbNavItem="2">
          <a ngbNavLink>
            <i class="me-2" antIcon theme="outline" type="setting"></i>
            Setting
          </a>
          <ng-template ngbNavContent>
            @for (task of setting; track task) {
              <div>
                <a class="dropdown-item">
                  <i class="text-muted" antIcon theme="outline" type="{{ task.icon }}"></i>
                  <span>{{ task.title }}</span>
                </a>
              </div>
            }
          </ng-template>
        </li>
      </ul>
      <div [ngbNavOutlet]="nav"></div>
    </div>
  </li>
</ul>
<!-- 
<ng-template #upgradeModal>
  <div class="modal-header premium-header">
    <h4 class="modal-title text-white fw-bold">Upgrade Your Subscription</h4>
    <button type="button" class="btn-close btn-close-white" (click)="modalService.dismissAll()"></button>
  </div>

  <div class="modal-body p-5" style="background:#f9f9f9;">

    <div class="current-plan-banner text-center mb-5 p-4 rounded-4 border-0" 
         style="background:#fff;box-shadow:0 10px 30px rgba(0,0,0,0.08);" 
         *ngIf="subscriptionData?.planType">
      <h5 class="mb-2 fw-bold">Current Plan: <span class="text-primary">{{ subscriptionData.name || subscriptionData.planType | titlecase }}</span></h5>
      <p class="text-muted small mb-0">Expires on {{ subscriptionData.expiresAt | date:'dd MMM yyyy' }}</p>
    </div>

    <h4 class="text-center mb-5 fw-bold text-dark">Choose Your Plan</h4>

    <div class="row g-4 justify-content-center">
      <div class="col-lg-6 col-md-6" *ngFor="let plan of plans">
        <div class="pricing-card-master position-relative overflow-hidden"
             [class.popular]="plan.value.includes('yearly') && !plan.value.includes('premium')"
             [class.best-value]="plan.value.includes('premium')"
             [class.current-plan-card]="subscriptionData?.planType === plan.value">

          <div class="ribbon ribbon-popular" *ngIf="plan.value.includes('yearly') && !plan.value.includes('premium')">
            MOST POPULAR
          </div>
          <div class="ribbon ribbon-best" *ngIf="plan.value.includes('premium')">
            BEST VALUE
          </div>
          <div class="ribbon ribbon-current" *ngIf="subscriptionData?.planType === plan.value">
            CURRENT PLAN
          </div>

          <div class="card-content p-5 text-center">
            <h5 class="fw-bold mb-4">{{ plan.name }}</h5>
            
            <div class="price mb-3">
              <h2 class="fw-bold mb-1">₹{{ plan.price | number }}</h2>
              <small class="text-muted d-block">/ {{ plan.value.includes('yearly') ? 'year' : 'month' }}</small>
            </div>

            <div class="save-badge" *ngIf="plan.value.includes('yearly')">
              Save up to 40%
            </div>

            <button class="btn btn-choose w-100 mt-4 py-3 rounded-pill fw-bold"
                    [disabled]="subscriptionData?.planType === plan.value || isLoading"
                    (click)="directUpgrade(plan.value)">
              <span *ngIf="isLoading && selectedPlan === plan.value" class="spinner-border spinner-border-sm me-2"></span>
              {{ subscriptionData?.planType === plan.value ? 'Current Plan' : 'Get Started' }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="text-center mt-5">
      <p class="text-muted small">
        Secured by <strong>Razorpay</strong> • Instant Activation • Trusted by 10,000+ Schools
      </p>
    </div>
  </div>

  <div class="modal-footer premium-header">
    <button class="btn btn-outline-light fw-bold px-4" (click)="modalService.dismissAll()">Close</button>
  </div>
</ng-template> -->