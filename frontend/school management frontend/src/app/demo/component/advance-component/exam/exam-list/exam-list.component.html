<div class="container-fluid">
  <header class="header">
    <h2>Exam List</h2>
    <button class="create-button" >Create New Exam</button>
  </header>

  <div class="exam-table">
    <table>
      <thead>
        <tr>
          <th>Exam Title</th>
          <th>Exam Class</th>
          <th>Exam Center</th>
          <th>Start Date</th>
          <th>End Date</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let exam of exams">
          <tr class="exam-row">
            <td>{{ exam.examTitle }}</td>
            <td>{{ exam.classId?.name }}</td>
            <td>{{ exam.examCenter }}</td>
            <td>{{ formatDate(exam.startDate) }}</td>
            <td>{{ formatDate(exam.endDate) }}</td>
            <td>
              <span class="status-badge" [ngClass]="{
                'status-scheduled': exam.examStatus === 'Scheduled',
                'status-ongoing': exam.examStatus === 'Ongoing',
                'status-completed': exam.examStatus === 'Completed'
              }">
                {{ exam.examStatus }}
              </span>
            </td>
            <td>
              <button class="action-button view" (click)="toggleRow(exam._id)">
                {{ expandedRows[exam._id] ? 'Hide' : 'View' }} Papers
              </button>
              <button class="action-button edit" (click)="editExam(exam._id)">Edit</button>
              <button class="action-button delete" (click)="deleteExam(exam._id)">Delete</button>
            </td>
          </tr>
          <tr *ngIf="expandedRows[exam._id]" class="details-row">
            <td colspan="7">
              <div class="exam-papers">
                <h3>Exam Papers</h3>
                <table class="papers-table">
                  <thead>
                    <tr>
                      <th>Subject</th>
                      <th>Type</th>
                      <th>Max Marks</th>
                      <th>Min Marks</th>
                      <th>Paper Code</th>
                      <th>Start Date & Time</th>
                      <th>End Date & Time</th>
                      <th>Room No</th>
                      <th>Grade Criteria</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let paper of exam.examPapers">
                      <td>{{ paper.subjectId.name }}</td>
                      <td>{{ paper.subjectType }}</td>
                      <td>{{ paper.maxMarks }}</td>
                      <td>{{ paper.minMarks }}</td>
                      <td>{{ paper.paperCode }}</td>
                      <td>{{ formatDate(paper.paperStartDateTime) }}</td>
                      <td>{{ formatDate(paper.paperEndDateTime) }}</td>
                      <td>{{ paper.roomNo }}</td>
                      <td>{{ paper.gradeCriteria }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>

    <div class="no-data" *ngIf="!exams.length">
      No exams found. Click "Create New Exam" to add one.
    </div>
  </div>
</div>