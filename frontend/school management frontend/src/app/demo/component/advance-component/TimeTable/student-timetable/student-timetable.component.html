<div class="timetable-wrapper">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <div>
        <h1 class="page-title">My Class Timetable</h1>
        <p class="page-subtitle">View your complete weekly schedule</p>
      </div>
      <div class="header-actions">
        <select class="form-select modern-select" 
                [(ngModel)]="selectedYearId" 
                (change)="onYearChange()">
          <option *ngFor="let year of academicYears" [value]="year._id">
            {{ year.name }}
          </option>
        </select>
        <div class="badge-modern bg-gradient-primary">
          {{ timetable.length }} Periods
        </div>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner-large"></div>
    <p>Loading your timetable...</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && timetable.length === 0" class="empty-state">
    <i class="bi bi-calendar-x display-1 text-muted opacity-50"></i>
    <h3>No Timetable Found</h3>
    <p>Your class schedule has not been assigned for the selected year.</p>
  </div>

  <!-- Timetable Card -->
  <div *ngIf="!isLoading && timetable.length > 0" class="timetable-card">
    <div class="timetable-header">
      <h4><i class="bi bi-clock-history me-2"></i>Weekly Schedule</h4>
      <div class="legend">
        <span class="legend-item"><span class="dot weekend"></span> Weekend</span>
        <span class="legend-item"><span class="dot break"></span> Break / Free</span>
      </div>
    </div>

    <div class="table-responsive">
      <table class="timetable-table">
        <thead>
          <tr>
            <th class="day-header">Day</th>
            <th *ngFor="let slot of timeSlots" class="slot-header">
              <div class="time">{{ slot.start }}</div>
              <small>to {{ slot.end }}</small>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let day of days; let dayIdx = index"
              [class.weekend-row]="isWeekend(day)">
            <td class="day-cell">
              <div class="day-name">{{ day }}</div>
              <div class="date-hint" *ngIf="isToday(day)">Today</div>
            </td>
            <td *ngFor="let cell of grid[dayIdx]" 
                class="period-cell"
                [class.break-cell]="!cell"
                [class.has-class]="cell">
              <ng-container *ngIf="cell; else breakSlot">
                <div class="subject">{{ cell.subject }}</div>
                <div class="teacher">{{ cell.teacher }}</div>
                <div class="room-badge">{{ cell.room || '—' }}</div>
              </ng-container>
              <ng-template #breakSlot>
                <span class="break-text">—</span>
              </ng-template>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="timetable-footer">
      <small>
        <i class="bi bi-info-circle-fill me-1"></i>
        Timetable auto-updates when teachers make changes
      </small>
    </div>
  </div>
</div>