<div class="container-fluid" style="margin-top: 10px;">
  <div class="row">
    <div [style.width]="isSidebarVisible ? '80%' : '100%'">
      <!-- Filters and Search -->
      <div class="d-flex justify-content-between align-items-center">
        <!-- Left Side: Filters and Search Button -->
        <div class="filters d-flex align-items-center">
          <select 
            class="form-control form-control-sm me-2" 
            [(ngModel)]="selectedClass" 
            (change)="onFilterChange()"
            style="width: 150px;">
            <option value="">All Classes</option>
            <option *ngFor="let classItem of classes" [value]="classItem._id">{{ classItem.name }}</option>
          </select>

          <select 
            class="form-control form-control-sm me-2" 
            [(ngModel)]="selectedSession" 
            (change)="onFilterChange()"
            style="width: 150px;">
            <option value="">All Sessions</option>
            <option *ngFor="let year of academicYears" [value]="year._id">{{ year.name }}</option>
          </select>

          <button class="btn btn-primary btn-sm" (click)="onSearch()">Search</button>
        </div>

        <!-- Right Side: Search Field -->
        <div class="search-field">
          <input 
            type="text" 
            class="form-control form-control-sm" 
            placeholder="Search by name or admission no" 
            [(ngModel)]="searchQuery" 
            (keyup.enter)="onSearch()"
            style="width: 250px;">
        </div>
      </div>

      <!-- Student Table -->
      <div class="table-container">
        <table class="professional-table table-striped table-sm">
          <thead>
            <tr>
              <th>#</th>
              <th>Name</th>
              <th>Admission No</th>
              <th>Class</th>
              <th>Contact</th>
              <th>Gender</th>
              <th>Status</th>

            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let student of students; let i = index" (click)="toggleSidebar(student._id)" >
              <td>
                <div ngbDropdown>
                  <button class="btn btn-link btn-sm" id="dropdownButton{{i}}" ngbDropdownToggle>
                    {{ (currentPage - 1) * pageSize + i + 1 }}
                  </button>
                  <div ngbDropdownMenu >
                    <button ngbDropdownItem (click)="onUpdateStudent(student._id)">Update</button>
                    <button ngbDropdownItem (click)="createPortal(student._id, 'student')" >Student Portal</button>
                    <button ngbDropdownItem (click)="createPortal(student._id, 'parent')">Parent Portal</button>
                  </div>
                </div>
              </td>
              <td class="profile-cell">
                <div class="profile-wrapper">
                  <img *ngIf="student.profileImage" crossorigin="anonymous"
                    [src]="getImageUrl(student.profileImage)"
                    alt="{{ student.name }} profile"
                    class="profile-avatar">
                  <div *ngIf="!student.profileImage" class="avatar-placeholder">
                    {{ getInitials(student.name) }}
                  </div>
                  <span class="student-name">{{ student.name }}</span>
                </div>
              </td>
              <td style="white-space: nowrap;">{{ student.admissionNo }}</td>
              <td>{{ student.classId?.name || 'N/A' }}</td>
              <td>
                <div>{{ student.phone }}</div>
              </td>
              <td>{{ student.gender }}</td>
              <td>{{ student.status }}</td>

            </tr>
            <tr *ngIf="students.length === 0">
              <td colspan="6" style="text-align: center; font-family: 'Poppins', sans-serif; font-weight: 600;">
                No Students Available
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- Pagination Component -->
      <app-pagination
        [currentPage]="currentPage"
        [pageSize]="pageSize"
        [totalItems]="totalItems"
        [pageSizeOptions]="pageSizeOptions"
        (pageChange)="onPageChange($event)">
      </app-pagination>
    </div>
    <div *ngIf="isSidebarVisible" class="sidebar">
  <div class="card shadow">
    <div class="img-container">
      <img 
        *ngIf="selectedStudent?.profileImage"  crossorigin="anonymous"
        [src]="getImageUrl(selectedStudent?.profileImage)" 
        [alt]="selectedStudent.name ? selectedStudent.name + ' profile' : 'Student profile'" 
        class="circle-img"
      >
      <div *ngIf="!selectedStudent?.profileImage || !getImageUrl(selectedStudent.profileImage)" class="avatar-placeholder">
        {{ selectedStudent?.name ? getInitials(selectedStudent.name) : 'N/A' }}
      </div>
    </div>

    <!-- Rest of your sidebar content remains the same -->
    <h4 style="font-family: 'Poppins',sans-serif;font-weight: 600;font-size: 14px;color: white;">Personal Details</h4>
    <div class="key-value">
      <div class="key-left">
        <h5 class="key-left-value">Student Name</h5>
        <h5 class="key-left-value">DOB</h5>
        <h5 class="key-left-value">Admission No</h5>
        <h5 class="key-left-value">Roll No</h5>
        <h5 class="key-left-value">Gender</h5>
        <h5 class="key-left-value">Address</h5>
      </div>
      <div class="key-right">
        <h5 class="key-left-value">{{ selectedStudent?.name || '' }}</h5>
        <h5 class="key-left-value">{{ selectedStudent?.dateOfBirth ? (selectedStudent.dateOfBirth | date:'dd/MM/yyyy') : '' }}</h5>
        <h5 class="key-left-value">{{ selectedStudent?.admissionNo || '' }}</h5>
        <h5 class="key-left-value">{{ selectedStudent?.rollNo || '-' }}</h5>
        <h5 class="key-left-value">{{ selectedStudent?.gender || '' }}</h5>
        <h5 class="key-left-value">{{ selectedStudent?.address || '' }}</h5>
      </div>
    </div>

    <h4 style="font-family: 'Poppins',sans-serif;font-weight: 600;font-size: 14px;color: white;">Parents Details</h4>
    <div class="key-value">
      <div class="key-left">
        <h5 class="key-left-value">Parents Name 1</h5>
        <h5 class="key-left-value">Parents Number 1</h5>
        <h5 class="key-left-value">Parents Name 2</h5>
        <h5 class="key-left-value">Parents Number 2</h5>
      </div>
      <div class="key-right">        
        <h5 class="key-left-value">{{ selectedStudent?.parents?.fatherName || '-' }}</h5>
        <h5 class="key-left-value">{{ selectedStudent?.parents?.fatherPhone || '-' }}</h5>
        <h5 class="key-left-value">{{ selectedStudent?.parents?.motherName || '-' }}</h5>
        <h5 class="key-left-value">{{ selectedStudent?.parents?.motherPhone || '-' }}</h5>
      </div>
    </div>

    <h4 style="font-family: 'Poppins',sans-serif;font-weight: 600;font-size: 14px;color: white;">Student Portal Details</h4>
    <div class="key-value">
      <div class="key-left">
        <h5 class="key-left-value">User Name</h5>
        <h5 class="key-left-value">Password</h5>
      </div>
      <div class="key-right">        
        <h5 class="key-left-value">{{ selectedStudent?.portalUsername || '-' }}</h5>
        <h5 class="key-left-value">{{ selectedStudent?.portalPassword || '-' }}</h5>
      </div>
    </div>
  </div>
</div>
  </div>
</div>
