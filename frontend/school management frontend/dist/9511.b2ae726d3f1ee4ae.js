"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[9511],{9511:(A,f,a)=>{a.r(f),a.d(f,{AssignmentDetailsComponent:()=>E});var _=a(177),m=a(9417),v=a(8359),t=a(4438),u=a(2867),F=a(5794),l=a(8652),r=a(749);function c(o,g){1&o&&(t.j41(0,"div",12)(1,"div",13)(2,"span",14),t.EFF(3,"Loading..."),t.k0s()(),t.j41(4,"p",15),t.EFF(5,"Loading assignments..."),t.k0s()())}function d(o,g){if(1&o){const e=t.RV6();t.j41(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",22)(4,"h5",23),t.EFF(5),t.k0s(),t.j41(6,"span",24),t.EFF(7),t.k0s()(),t.j41(8,"div",25)(9,"div",26),t.nrm(10,"i",27),t.j41(11,"span"),t.EFF(12),t.k0s()(),t.j41(13,"div",26),t.nrm(14,"i",28),t.j41(15,"span"),t.EFF(16),t.k0s()(),t.j41(17,"div",29),t.nrm(18,"i",30),t.j41(19,"span"),t.EFF(20),t.nI1(21,"date"),t.k0s()()(),t.j41(22,"button",31),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG(2),b=t.sdS(15);return t.Njj(s.openAssignmentDetails(n._id,b))}),t.nrm(23,"i",32),t.EFF(24," Grade Students "),t.k0s()()()()}if(2&o){const e=g.$implicit,i=t.XpG(2);t.R7$(5),t.JRh(e.title),t.R7$(),t.AVh("bg-warning","pending"===e.status)("bg-success","submitted"===e.status)("bg-info","graded"===e.status),t.R7$(),t.SpI(" ",e.status," "),t.R7$(5),t.JRh((null==e.subjectId?null:e.subjectId.name)||"No subject"),t.R7$(4),t.JRh((null==e.classId?null:e.classId.name)||"No class"),t.R7$(4),t.SpI("Due: ",t.i5U(21,12,e.dueDate,"MMM d, y"),""),t.R7$(2),t.Y8G("disabled",i.isLoading)}}function h(o,g){1&o&&(t.j41(0,"div",33)(1,"div",12),t.nrm(2,"i",34),t.j41(3,"h4",35),t.EFF(4,"No Assignments"),t.k0s(),t.j41(5,"p",36),t.EFF(6,"You don't have any pending assignments to grade."),t.k0s()()())}function p(o,g){if(1&o&&(t.j41(0,"div",16),t.DNE(1,d,25,15,"div",17)(2,h,7,0,"div",18),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.Y8G("ngForOf",e.assignments),t.R7$(),t.Y8G("ngIf",0===e.assignments.length&&!e.isLoading)}}function j(o,g){if(1&o){const e=t.RV6();t.j41(0,"div",75)(1,"div",21)(2,"div",22)(3,"h6",76),t.EFF(4),t.k0s(),t.j41(5,"div",77)(6,"input",78),t.mxI("ngModelChange",function(n){const s=t.eBV(e).$implicit;return t.DH7(s.submitted,n)||(s.submitted=n),t.Njj(n)}),t.k0s(),t.j41(7,"label",79),t.EFF(8,"Submitted"),t.k0s()()(),t.j41(9,"div",50)(10,"div",80)(11,"label",81),t.EFF(12,"Grade"),t.k0s(),t.j41(13,"input",82),t.mxI("ngModelChange",function(n){const s=t.eBV(e).$implicit;return t.DH7(s.grade,n)||(s.grade=n),t.Njj(n)}),t.k0s()(),t.j41(14,"div",80)(15,"label",81),t.EFF(16,"Solved"),t.k0s(),t.j41(17,"input",83),t.mxI("ngModelChange",function(n){const s=t.eBV(e).$implicit;return t.DH7(s.questionsSolved,n)||(s.questionsSolved=n),t.Njj(n)}),t.k0s()(),t.j41(18,"div",33)(19,"label",81),t.EFF(20,"Comments"),t.k0s(),t.j41(21,"input",84),t.mxI("ngModelChange",function(n){const s=t.eBV(e).$implicit;return t.DH7(s.comments,n)||(s.comments=n),t.Njj(n)}),t.k0s()()()()()}if(2&o){const e=g.$implicit;t.R7$(4),t.JRh(e.name),t.R7$(2),t.R50("ngModel",e.submitted),t.R7$(7),t.R50("ngModel",e.grade),t.R7$(4),t.R50("ngModel",e.questionsSolved),t.R7$(4),t.R50("ngModel",e.comments)}}function k(o,g){if(1&o){const e=t.RV6();t.j41(0,"tr")(1,"td")(2,"strong"),t.EFF(3),t.k0s()(),t.j41(4,"td",85)(5,"div",86)(6,"input",78),t.mxI("ngModelChange",function(n){const s=t.eBV(e).$implicit;return t.DH7(s.submitted,n)||(s.submitted=n),t.Njj(n)}),t.k0s()()(),t.j41(7,"td")(8,"input",87),t.mxI("ngModelChange",function(n){const s=t.eBV(e).$implicit;return t.DH7(s.grade,n)||(s.grade=n),t.Njj(n)}),t.k0s()(),t.j41(9,"td")(10,"input",88),t.mxI("ngModelChange",function(n){const s=t.eBV(e).$implicit;return t.DH7(s.comments,n)||(s.comments=n),t.Njj(n)}),t.k0s()(),t.j41(11,"td")(12,"input",89),t.mxI("ngModelChange",function(n){const s=t.eBV(e).$implicit;return t.DH7(s.questionsSolved,n)||(s.questionsSolved=n),t.Njj(n)}),t.k0s()()()}if(2&o){const e=g.$implicit;t.R7$(3),t.JRh(e.name),t.R7$(3),t.R50("ngModel",e.submitted),t.R7$(2),t.R50("ngModel",e.grade),t.R7$(2),t.R50("ngModel",e.comments),t.R7$(2),t.R50("ngModel",e.questionsSolved)}}function D(o,g){if(1&o){const e=t.RV6();t.j41(0,"div",37)(1,"div",38)(2,"div",22)(3,"div")(4,"h4",39),t.EFF(5),t.k0s(),t.j41(6,"div",40)(7,"span",41),t.nrm(8,"i",42),t.EFF(9),t.k0s(),t.j41(10,"span",41),t.nrm(11,"i",43),t.EFF(12),t.k0s(),t.j41(13,"span",41),t.nrm(14,"i",44),t.EFF(15),t.nI1(16,"date"),t.k0s()()(),t.j41(17,"button",45),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.closeModal())}),t.k0s()()()(),t.j41(18,"div",46)(19,"div",47)(20,"div",21)(21,"h6",48),t.nrm(22,"i",49),t.EFF(23,"Quick Actions "),t.k0s(),t.j41(24,"div",50)(25,"div",51),t.nrm(26,"input",52,1),t.k0s(),t.j41(28,"div",53),t.nrm(29,"input",54,2),t.k0s(),t.j41(31,"div",55)(32,"button",56),t.bIt("click",function(){t.eBV(e);const n=t.sdS(27),s=t.sdS(30),b=t.XpG();return b.applyToAll("grade",n.value),t.Njj(b.applyToAll("comments",s.value))}),t.EFF(33," Apply to All "),t.k0s()()()()(),t.j41(34,"div",57)(35,"div",58)(36,"h6",59),t.EFF(37),t.k0s(),t.j41(38,"button",60),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.saveAllGrades())}),t.nrm(39,"i",61),t.EFF(40),t.k0s()(),t.j41(41,"div",62),t.DNE(42,j,22,5,"div",63),t.k0s(),t.j41(43,"div",7)(44,"div",64)(45,"table",65)(46,"thead",66)(47,"tr")(48,"th",67),t.EFF(49,"Student"),t.k0s(),t.j41(50,"th",68),t.EFF(51,"Submitted"),t.k0s(),t.j41(52,"th",69),t.EFF(53,"Grade"),t.k0s(),t.j41(54,"th",70),t.EFF(55,"Comments"),t.k0s(),t.j41(56,"th",69),t.EFF(57,"Solved"),t.k0s()()(),t.j41(58,"tbody"),t.DNE(59,k,13,5,"tr",71),t.k0s()()()()()(),t.j41(60,"div",72)(61,"button",73),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.closeModal())}),t.EFF(62,"Close"),t.k0s(),t.j41(63,"button",74),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.saveAllGrades())}),t.nrm(64,"i",61),t.EFF(65),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(5),t.JRh(null==e.selectedAssignment?null:e.selectedAssignment.title),t.R7$(4),t.SpI(" ",null==e.selectedAssignment||null==e.selectedAssignment.subjectId?null:e.selectedAssignment.subjectId.name," "),t.R7$(3),t.SpI(" ",null==e.selectedAssignment||null==e.selectedAssignment.classId?null:e.selectedAssignment.classId.name," "),t.R7$(3),t.SpI(" Due: ",t.i5U(16,11,null==e.selectedAssignment?null:e.selectedAssignment.dueDate,"MMM d, y")," "),t.R7$(22),t.SpI("Students (",e.students.length,")"),t.R7$(),t.Y8G("disabled",e.isLoading),t.R7$(2),t.SpI(" ",e.isLoading?"Saving...":"Save All"," "),t.R7$(2),t.Y8G("ngForOf",e.students),t.R7$(17),t.Y8G("ngForOf",e.students),t.R7$(4),t.Y8G("disabled",e.isLoading),t.R7$(2),t.SpI(" ",e.isLoading?"Saving...":"Save All Grades"," ")}}let E=(()=>{class o{constructor(e,i,n,s){this.assignmentService=e,this.toastr=i,this.modalService=n,this.router=s,this.assignments=[],this.selectedAssignment=null,this.students=[],this.isLoading=!1,this.subscriptions=new v.yU,this.teacherId=localStorage.getItem("teacherId")}ngOnInit(){this.teacherId?this.loadAssignments():this.toastr.error("Teacher ID not found")}ngOnDestroy(){this.subscriptions.unsubscribe()}createAssignment(){this.router.navigate(["assignment-create"])}loadAssignments(){this.isLoading=!0,this.subscriptions.add(this.assignmentService.getTeacherAssignments(this.teacherId).subscribe({next:e=>{this.assignments=e.data,this.isLoading=!1},error:e=>{this.toastr.error("Failed to load assignments."),this.isLoading=!1}}))}openAssignmentDetails(e,i){this.isLoading=!0,this.subscriptions.add(this.assignmentService.getAssignmentDetails(e).subscribe({next:n=>{this.selectedAssignment=n.data.assignment,this.students=n.data.students.map(s=>({...s,submitted:s.submitted||!1,questionsSolved:s.questionsSolved||0,grade:s.grade||"",comments:s.comments||""})),this.isLoading=!1,this.modalService.open(i,{size:"xl",scrollable:!0})},error:n=>{this.toastr.error("Failed to load assignment details"),this.isLoading=!1}}))}applyToAll(e,i){this.students.forEach(n=>{n[e]=i}),this.toastr.info(`Applied ${e} to all students`)}saveAllGrades(){this.isLoading=!0;const e=this.students.map(i=>({studentId:i._id,grade:i.grade?Number(i.grade):null,comments:i.comments||"",questionsSolved:i.questionsSolved||0,submitted:i.submitted}));this.subscriptions.add(this.assignmentService.bulkGradeAssignment(this.selectedAssignment._id,e).subscribe({next:()=>{this.toastr.success("All grades saved successfully!"),this.isLoading=!1},error:i=>{this.toastr.error("Failed to save grades"),this.isLoading=!1}}))}closeModal(){this.modalService.dismissAll(),this.selectedAssignment=null}static{this.\u0275fac=function(i){return new(i||o)(t.rXU(u.h),t.rXU(F.tw),t.rXU(l.Bq),t.rXU(r.Ix))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-assignment-details"]],decls:16,vars:3,consts:[["content",""],["gradeInput",""],["commentInput",""],[1,"container-fluid","py-3"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"mb-1"],[1,"text-muted","mb-0"],[1,"d-none","d-md-block"],[1,"badge","bg-primary","fs-6"],[1,"btn","btn-sm","btn-primary",3,"click"],["class","text-center py-5",4,"ngIf"],["class","row g-3",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2","text-muted"],[1,"row","g-3"],["class","col-12 col-md-6 col-lg-4",4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],[1,"col-12","col-md-6","col-lg-4"],[1,"assignment-card","card","h-100","shadow-sm","border-0"],[1,"card-body"],[1,"d-flex","justify-content-between","align-items-start","mb-3"],[1,"card-title","text-truncate","mb-0","me-2"],[1,"badge"],[1,"assignment-meta","mb-3"],[1,"d-flex","align-items-center","text-muted","small","mb-2"],[1,"bi","bi-book","me-2"],[1,"bi","bi-people","me-2"],[1,"d-flex","align-items-center","text-muted","small"],[1,"bi","bi-calendar","me-2"],[1,"btn","btn-primary","w-100",3,"click","disabled"],[1,"bi","bi-pencil-square","me-2"],[1,"col-12"],[1,"bi","bi-inbox","display-1","text-muted"],[1,"mt-3","text-muted"],[1,"text-muted"],[1,"modal-header","border-0","pb-0"],[1,"w-100"],[1,"modal-title","text-primary","mb-1"],[1,"d-flex","flex-wrap","gap-2","text-muted","small"],[1,"d-flex","align-items-center"],[1,"bi","bi-book","me-1"],[1,"bi","bi-people","me-1"],[1,"bi","bi-calendar","me-1"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body","pt-0"],[1,"quick-actions-card","card","border-0","bg-light","mb-4"],[1,"card-title","mb-3"],[1,"bi","bi-lightning","me-2"],[1,"row","g-2"],[1,"col-12","col-sm-4"],["type","number","placeholder","Grade for all","min","0","max","100",1,"form-control"],[1,"col-12","col-sm-5"],["type","text","placeholder","Comment for all",1,"form-control"],[1,"col-12","col-sm-3"],[1,"btn","btn-outline-primary","w-100",3,"click"],[1,"students-section"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"mb-0"],[1,"btn","btn-success","btn-sm",3,"click","disabled"],[1,"bi","bi-check-lg","me-1"],[1,"d-md-none"],["class","student-card card mb-3",4,"ngFor","ngForOf"],[1,"table-container"],[1,"table","table-hover","align-middle"],[1,"table-light"],["scope","col",1,"w-25"],["scope","col",1,"w-15","text-center"],["scope","col",1,"w-15"],["scope","col",1,"w-30"],[4,"ngFor","ngForOf"],[1,"modal-footer","border-0"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"student-card","card","mb-3"],[1,"card-title","mb-0"],[1,"form-check","form-switch"],["type","checkbox","role","switch",1,"form-check-input",3,"ngModelChange","ngModel"],[1,"form-check-label","small"],[1,"col-6"],[1,"form-label","small","text-muted"],["type","number","min","0","max","100","placeholder","0-100",1,"form-control",3,"ngModelChange","ngModel"],["type","number","min","0","placeholder","0",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Add comments",1,"form-control",3,"ngModelChange","ngModel"],[1,"text-center"],[1,"form-check","form-switch","d-inline-block"],["type","number","min","0","max","100","placeholder","0-100",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"],["type","text","placeholder","Add comments",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"],["type","number","min","0","placeholder","0",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"]],template:function(i,n){if(1&i){const s=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"div")(3,"h2",5),t.EFF(4,"My Assignments"),t.k0s(),t.j41(5,"p",6),t.EFF(6,"Manage and grade student assignments"),t.k0s()(),t.j41(7,"div",7)(8,"span",8),t.EFF(9),t.k0s(),t.j41(10,"button",9),t.bIt("click",function(){return t.eBV(s),t.Njj(n.createAssignment())}),t.EFF(11,"create"),t.k0s()()(),t.DNE(12,c,6,0,"div",10)(13,p,3,2,"div",11),t.k0s(),t.DNE(14,D,66,14,"ng-template",null,0,t.C5r)}2&i&&(t.R7$(9),t.SpI("",n.assignments.length," assignments"),t.R7$(3),t.Y8G("ngIf",n.isLoading&&0===n.assignments.length),t.R7$(),t.Y8G("ngIf",!n.isLoading||n.assignments.length>0))},dependencies:[_.MD,_.Sq,_.bT,_.vh,m.YN,m.me,m.Q0,m.Zm,m.BC,m.VZ,m.zX,m.vS],encapsulation:2})}}return o})()},2867:(A,f,a)=>{a.d(f,{h:()=>t});var _=a(2525),m=a(4438),v=a(1626);let t=(()=>{class u{constructor(l){this.http=l,this.apiUrl=_.c.apiUrl}createAssignment(l,r,c){const d=new FormData;d.append("title",l.title||""),d.append("description",l.description||""),d.append("dueDate",l.dueDate||""),d.append("classId",l.classId||""),d.append("subjectId",l.subjectId||""),l.assignedTo&&Array.isArray(l.assignedTo)&&l.assignedTo.forEach((p,j)=>{d.append(`assignedTo[${j}]`,p)}),r&&Array.isArray(r)&&r.forEach(p=>{d.append("attachments",p)});const h=`${this.apiUrl}/api/assignments/create?teacherId=${encodeURIComponent(c||"")}`;return console.log(h),this.http.post(h,d)}logManualSubmission(l,r){return this.http.post(`${this.apiUrl}/api/assignments/${l}/log-submission`,{studentId:r})}gradeAssignment(l,r,c,d,h){return this.http.put(`${this.apiUrl}/api/assignments/${l}/grade`,{studentId:r,grade:c,comments:d})}bulkGradeAssignment(l,r){return this.http.put(`${this.apiUrl}/api/assignments/${l}/bulk-grade`,{grades:r})}getTeacherAssignments(l){return this.http.get(`${this.apiUrl}/api/assignments/teacher/${l}`)}getAssignmentDetails(l){return this.http.get(`${this.apiUrl}/api/assignments/${l}/details`)}getStudentAssignments(){return this.http.get(`${this.apiUrl}/api/assignments/student`)}getStudentAssignmentDetails(l){return this.http.get(`${this.apiUrl}/api/assignments/my-assignment/${l}`)}static{this.\u0275fac=function(r){return new(r||u)(m.KVO(v.Qq))}}static{this.\u0275prov=m.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()}}]);