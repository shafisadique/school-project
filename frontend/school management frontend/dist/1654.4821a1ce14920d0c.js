"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[1654],{3891:(_,g,a)=>{a.d(g,{e:()=>m});var r=a(1626),u=a(2525),e=a(4438);let m=(()=>{class l{constructor(t){this.http=t,this.apiUrl=u.c.apiUrl}getClassesBySchool(t){return this.http.get(`${this.apiUrl}/api/class-subject-management/classes/${t}`)}getStudentsByClass(t,s){const i=`${this.apiUrl}/api/students/get-student-by-class/${t}`,n=(new r.Nl).set("academicYearId",s);return this.http.get(i,{params:n})}assignRollNumbers(t){return this.http.post(`${this.apiUrl}/api/students/assign-roll-numbers?classId=${t}`,{})}assignRollNumbersAlphabetically(t){return this.http.post(`${this.apiUrl}/api/students/assign-roll-numbers-alphabetically?classId=${t}`,{})}assignRollNumberToStudent(t,s){return this.http.put(`${this.apiUrl}/api/students/${t}/assign-roll-number`,{rollNo:s})}createClass(t){return this.http.post(`${this.apiUrl}/api/class-subject-management/classes`,t)}deleteAssignment(t){return this.http.delete(`${this.apiUrl}/api/class-subject-management/assign-subject`,{body:t})}createSubject(t){return this.http.post(`${this.apiUrl}/api/class-subject-management/subject`,t)}getSubjects(t){return this.http.get(`${this.apiUrl}/api/class-subject-management/subjects/${t}`)}getTeachers(t){return this.http.get(`${this.apiUrl}/api/class-subject-management/teachers/by-school/${t}`)}getCombinedAssignments(t,s){const i=(new r.Nl).set("academicYearId",s);return this.http.get(`${this.apiUrl}/api/class-subject-management/assignments/${t}`,{params:i})}assignSubjectToClass(t,s,i,n){return this.http.post(`${this.apiUrl}/api/class-subject-management/assign-subject`,{classId:t,subjectId:s,teacherId:i,academicYearId:n})}updateAssignment(t){return this.http.put(`${this.apiUrl}/api/class-subject-management/assign-subject`,t)}getAssignmentsByTeacher(t,s,i){let n=(new r.Nl).set("academicYearId",s);return i&&(n=n.set("date",i)),this.http.get(`${this.apiUrl}/api/class-subject-management/assignments/teacher/${t}`,{params:n})}updateAttendanceTeachers(t,s,i){return this.http.put(`${this.apiUrl}/api/class-subject-management/update-attendance-teachers`,{classId:t,attendanceTeacher:s,substituteAttendanceTeachers:i})}getTeacherAttendanceClasses(){return this.http.get(`${this.apiUrl}/api/class-subject-management/teacher-classes`)}static{this.\u0275fac=function(s){return new(s||l)(e.KVO(r.Qq))}}static{this.\u0275prov=e.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})()},1654:(_,g,a)=>{a.r(g),a.d(g,{ClassFeeReceiptComponent:()=>i});var r=a(9417),u=a(177),e=a(4438),m=a(2329),l=a(6561),f=a(3891),t=a(5794);function s(n,C){if(1&n&&(e.j41(0,"option",7),e.EFF(1),e.k0s()),2&n){const o=C.$implicit;e.Y8G("value",o),e.R7$(),e.JRh(o)}}let i=(()=>{class n{constructor(o,p,c,h){this.feeService=o,this.authService=p,this.classSubjectService=c,this.toastr=h,this.classList=[],this.selectedClass="",this.selectedMonth="",this.schoolId=""}ngOnInit(){this.schoolId=this.authService.getSchoolId(),this.schoolId&&this.loadClasses()}loadClasses(){this.classSubjectService.getClassesBySchool(this.schoolId).subscribe({next:o=>this.classList=o.map(p=>p.name),error:o=>this.toastr.error("Error fetching classes: "+o.message)})}generateReceipts(){if(!this.selectedClass||!this.selectedMonth)return void this.toastr.error("Please select a class and month");const o={schoolId:this.authService.getSchoolId(),className:this.selectedClass,month:this.selectedMonth};this.feeService.generateClassReceipts(o).subscribe({next:p=>{const c=window.URL.createObjectURL(p),h=document.createElement("a");h.href=c,h.download=`class_receipts_${this.selectedClass}_${this.selectedMonth}.zip`,h.click(),this.toastr.success("Receipts generated successfully")},error:p=>this.toastr.error("Failed to generate receipts: "+p.message)})}static{this.\u0275fac=function(p){return new(p||n)(e.rXU(m.G),e.rXU(l.u),e.rXU(f.e),e.rXU(t.tw))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-class-fee-receipt"]],decls:11,vars:4,consts:[[1,"row","g-3"],[1,"col-md-4"],[1,"form-select",3,"ngModelChange","ngModel"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["type","month",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-primary","w-100",3,"click","disabled"],[3,"value"]],template:function(p,c){1&p&&(e.j41(0,"div",0)(1,"div",1)(2,"select",2),e.mxI("ngModelChange",function(d){return e.DH7(c.selectedClass,d)||(c.selectedClass=d),d}),e.j41(3,"option",3),e.EFF(4,"Select Class"),e.k0s(),e.DNE(5,s,2,2,"option",4),e.k0s()(),e.j41(6,"div",1)(7,"input",5),e.mxI("ngModelChange",function(d){return e.DH7(c.selectedMonth,d)||(c.selectedMonth=d),d}),e.k0s()(),e.j41(8,"div",1)(9,"button",6),e.bIt("click",function(){return c.generateReceipts()}),e.EFF(10," Generate Class Receipts "),e.k0s()()()),2&p&&(e.R7$(2),e.R50("ngModel",c.selectedClass),e.R7$(3),e.Y8G("ngForOf",c.classList),e.R7$(2),e.R50("ngModel",c.selectedMonth),e.R7$(2),e.Y8G("disabled",!c.selectedClass||!c.selectedMonth))},dependencies:[u.MD,u.Sq,r.YN,r.xH,r.y7,r.me,r.wz,r.BC,r.vS],encapsulation:2})}}return n})()},2329:(_,g,a)=>{a.d(g,{G:()=>m});var r=a(2525),u=a(4438),e=a(1626);let m=(()=>{class l{constructor(t){this.http=t,this.apiUrl=r.c.apiUrl}getFeeStructures(t){return this.http.get(`${this.apiUrl}/api/fees/structures`,{params:{schoolId:t}})}getStudentInvoices(t,s){const i={};return s&&(i.academicYearId=s),this.http.get(`${this.apiUrl}/api/fees/invoices/student/${t}`,{params:i})}searchInvoiceStudents(t,s){return this.http.get(`${this.apiUrl}/api/fees/search`,{params:{q:t,schoolId:s}})}createFeeStructure(t){return this.http.post(`${this.apiUrl}/api/fees/structures`,t)}updateFeeStructure(t,s){return this.http.put(`${this.apiUrl}/api/fees/structures/${t}`,s)}deleteFeeStructure(t){return this.http.delete(`${this.apiUrl}/api/fees/structures/${t}`)}generateInvoices(t){return this.http.post(`${this.apiUrl}/api/fees/generate`,t)}getStudentFeeSummary(t){return this.http.get(`${this.apiUrl}/api/fees/students/${t}/summary`)}getInvoiceById(t){return this.http.get(`${this.apiUrl}/api/fees/invoices/${t}`)}generateAdvanceInvoices(t){return this.http.post(`${this.apiUrl}/api/fees/invoices/advance`,t)}processPayment(t,s){return this.http.post(`${this.apiUrl}/api/fees/students/${t}/payments`,s)}getFeeCollectionReport(t){return this.http.get(`${this.apiUrl}/api/fees/reports/collection-details`,{params:t})}generateClassReceipts(t){return this.http.post(`${this.apiUrl}/api/fees/receipts`,t,{responseType:"blob"})}getPaidInvoiceList(t){return this.http.get(`${this.apiUrl}/api/fees/paid-invoices`,{params:t})}getInvoicesByClassAndMonth(t,s,i){return this.http.get(`${this.apiUrl}/api/fees/invoices`,{params:{classId:t,month:s,academicYearId:i}})}getStudentPaymentHistory(t){return this.http.get(`${this.apiUrl}/api/fees/students/${t}/payment-history`)}downloadInvoicePDF(t){return this.http.get(`${this.apiUrl}/api/fees/invoices/${t}/pdf`,{responseType:"blob"})}downloadReceiptPDF(t){return this.http.get(`${this.apiUrl}/api/fees/receipts/${t}/pdf`,{responseType:"blob"})}notifyParents(t,s,i){return this.http.post(`${this.apiUrl}/api/fees/notify-parents`,{classId:t,month:s,academicYearId:i})}static{this.\u0275fac=function(s){return new(s||l)(u.KVO(e.Qq))}}static{this.\u0275prov=u.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})()}}]);