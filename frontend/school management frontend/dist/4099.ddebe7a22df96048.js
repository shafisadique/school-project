"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[4099],{4099:(v,p,o)=>{o.r(p),o.d(p,{SubscriptionPlansComponent:()=>P});var l=o(177),c=o(9417),d=o(2525),n=o(4438),u=o(4574),b=o(5794);function g(i,a){if(1&i&&(n.j41(0,"div",12)(1,"span",13),n.EFF(2),n.nI1(3,"titlecase"),n.k0s()()),2&i){const t=n.XpG();n.R7$(2),n.SpI(" Current Plan: ",n.bMT(3,1,t.currentPlanType)," ")}}function f(i,a){1&i&&(n.j41(0,"div",29),n.EFF(1,"MOST POPULAR"),n.k0s())}function m(i,a){1&i&&(n.j41(0,"div",30),n.EFF(1,"BEST VALUE"),n.k0s())}function h(i,a){1&i&&(n.j41(0,"div",31),n.EFF(1," Save up to 40% "),n.k0s())}function _(i,a){1&i&&n.nrm(0,"span",32)}function y(i,a){if(1&i){const t=n.RV6();n.j41(0,"div",14)(1,"div",15),n.DNE(2,f,2,0,"div",16)(3,m,2,0,"div",17),n.j41(4,"div",18)(5,"h3",19),n.EFF(6),n.k0s(),n.j41(7,"div",20)(8,"h2",21),n.EFF(9),n.nI1(10,"number"),n.k0s(),n.j41(11,"p",22),n.EFF(12),n.k0s()(),n.DNE(13,h,2,0,"div",23),n.j41(14,"ul",24)(15,"li",25)(16,"strong"),n.EFF(17),n.nI1(18,"number"),n.k0s(),n.EFF(19," SMS"),n.k0s(),n.j41(20,"li",25)(21,"strong"),n.EFF(22),n.nI1(23,"number"),n.k0s(),n.EFF(24," WhatsApp"),n.k0s(),n.j41(25,"li",25),n.EFF(26,"Instant Activation"),n.k0s(),n.j41(27,"li",25),n.EFF(28,"Priority Support"),n.k0s(),n.j41(29,"li",26),n.EFF(30,"All Core Features"),n.k0s()(),n.j41(31,"button",27),n.bIt("click",function(){const r=n.eBV(t).$implicit,s=n.XpG();return n.Njj(s.selectPlan(r))}),n.DNE(32,_,1,0,"span",28),n.EFF(33),n.k0s()()()()}if(2&i){const t=a.$implicit,e=n.XpG();n.R7$(),n.AVh("popular",2===t.priority)("best-value",t.planType.includes("premium")),n.R7$(),n.Y8G("ngIf",2===t.priority),n.R7$(),n.Y8G("ngIf",t.planType.includes("premium")),n.R7$(3),n.JRh(t.name),n.R7$(3),n.SpI("\u20b9",n.bMT(10,15,t.price),""),n.R7$(3),n.SpI("/ ",t.isYearly?"year":"month",""),n.R7$(),n.Y8G("ngIf",t.isYearly),n.R7$(4),n.JRh(n.bMT(18,17,t.sms)),n.R7$(5),n.JRh(n.bMT(23,19,t.whatsapp)),n.R7$(9),n.Y8G("disabled",t.planType===e.currentPlanType||e.isLoading),n.R7$(),n.Y8G("ngIf",e.isLoading),n.R7$(),n.SpI(" ",t.planType===e.currentPlanType?"Current Plan":"GET STARTED"," ")}}let P=(()=>{class i{constructor(t,e){this.subscriptionService=t,this.toastr=e,this.plans=[],this.currentPlanType=null,this.isLoading=!1,this.viewMode="monthly"}ngOnInit(){this.loadCurrentPlan(),this.loadPlans()}loadCurrentPlan(){this.subscriptionService.getCurrentSubscription().subscribe({next:t=>{this.currentPlanType=t.planType},error:()=>{this.currentPlanType=null,this.toastr.warning("Could not load current plan")}})}loadPlans(){this.isLoading=!0,this.subscriptionService.getPlans().subscribe({next:t=>{this.plans=Object.values(t).map(e=>({...e,isYearly:e.planType.includes("yearly")})),this.plans.sort((e,r)=>e.priority-r.priority),this.isLoading=!1},error:()=>{this.toastr.error("Failed to load subscription plans"),this.isLoading=!1}})}toggleViewMode(t){this.viewMode=t}getFilteredPlans(){return this.plans.filter(t=>"yearly"===this.viewMode?t.isYearly:!t.isYearly)}selectPlan(t){t.planType!==this.currentPlanType?this.isLoading||(this.isLoading=!0,this.subscriptionService.upgradeSubscription({planType:t.planType}).subscribe({next:e=>{this.toastr.info(`Initiating upgrade to ${t.name}...`),e.order?this.initiateRazorpayPayment(e.order,t):(this.toastr.success("Plan upgraded successfully!"),this.currentPlanType=t.planType,this.isLoading=!1)},error:e=>{this.toastr.error(e.error?.message||"Upgrade failed. Please try again."),this.isLoading=!1}})):this.toastr.info("This is your current plan")}initiateRazorpayPayment(t,e){const r={key:d.c.razorpayKey,amount:t.amount,currency:t.currency||"INR",name:"Your School Management System",description:`Upgrade to ${e.name}`,image:"/assets/images/logo.png",order_id:t.id,prefill:{name:"Admin Name",email:"admin@school.com",contact:"9999999999"},handler:s=>{this.handlePaymentSuccess(s,e.planType)},modal:{ondismiss:()=>{this.toastr.info("Payment was cancelled"),this.isLoading=!1}},theme:{color:"#667eea"}};try{new window.Razorpay(r).open()}catch{this.toastr.error("Failed to open Razorpay. Please try again."),this.isLoading=!1}}handlePaymentSuccess(t,e){this.subscriptionService.verifyPayment({...t,planType:e}).subscribe({next:r=>{this.toastr.success("Payment successful! Your plan is now upgraded."),this.currentPlanType=e,this.isLoading=!1,setTimeout(()=>window.location.reload(),2e3)},error:r=>{this.toastr.error("Payment verification failed. Contact support with payment ID."),this.isLoading=!1}})}static{this.\u0275fac=function(e){return new(e||i)(n.rXU(u.n),n.rXU(b.tw))}}static{this.\u0275cmp=n.VBU({type:i,selectors:[["app-subscription-plans"]],decls:18,vars:10,consts:[[1,"subscription-page"],[1,"container"],[1,"text-center","mb-5"],[1,"display-4","fw-bold","text-white","mb-3"],[1,"lead","text-white-75"],[1,"toggle-container","text-center","mb-5"],["role","group",1,"btn-group","btn-group-lg"],["type","button",1,"btn",3,"click"],["class","current-plan text-center mb-5",4,"ngIf"],[1,"row","g-5","justify-content-center"],["class","col-lg-4 col-md-6",4,"ngFor","ngForOf"],[1,"text-center","mt-5","text-white-75"],[1,"current-plan","text-center","mb-5"],[1,"badge","bg-warning","text-dark","px-4","py-2"],[1,"col-lg-4","col-md-6"],[1,"plan-card","position-relative","h-100"],["class","ribbon ribbon-popular",4,"ngIf"],["class","ribbon ribbon-best",4,"ngIf"],[1,"card-body","text-center","p-5","d-flex","flex-column"],[1,"fw-bold","mb-4","text-white"],[1,"price","mb-4"],[1,"display-4","fw-bold","text-white","mb-0"],[1,"text-white-75","fs-5"],["class","save-badge mx-auto mb-4",4,"ngIf"],[1,"list-unstyled","features","mb-5","flex-grow-1"],[1,"mb-3","text-white"],[1,"text-white"],[1,"btn","btn-choose","mt-auto","py-3","px-5","rounded-pill","fw-bold",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],[1,"ribbon","ribbon-popular"],[1,"ribbon","ribbon-best"],[1,"save-badge","mx-auto","mb-4"],[1,"spinner-border","spinner-border-sm","me-2"]],template:function(e,r){1&e&&(n.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),n.EFF(4," Flexible pricing for schools of all sizes "),n.k0s(),n.j41(5,"p",4),n.EFF(6," Simple, transparent pricing. Upgrade anytime. "),n.k0s()(),n.j41(7,"div",5)(8,"div",6)(9,"button",7),n.bIt("click",function(){return r.toggleViewMode("monthly")}),n.EFF(10," MONTHLY "),n.k0s(),n.j41(11,"button",7),n.bIt("click",function(){return r.toggleViewMode("yearly")}),n.EFF(12," ANNUAL "),n.k0s()()(),n.DNE(13,g,4,3,"div",8),n.j41(14,"div",9),n.DNE(15,y,34,21,"div",10),n.k0s(),n.j41(16,"div",11),n.EFF(17," Secured by Razorpay \u2022 Instant Activation \u2022 Trusted by 10,000+ Schools "),n.k0s()()()),2&e&&(n.R7$(9),n.AVh("btn-primary","monthly"===r.viewMode)("btn-outline-light","monthly"!==r.viewMode),n.R7$(2),n.AVh("btn-primary","yearly"===r.viewMode)("btn-outline-light","yearly"!==r.viewMode),n.R7$(2),n.Y8G("ngIf",r.currentPlanType),n.R7$(2),n.Y8G("ngForOf",r.getFilteredPlans()))},dependencies:[l.MD,l.Sq,l.bT,l.QX,l.PV,c.YN],styles:[".subscription-page[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0f0c29,#302b63,#24243e);min-height:100vh;color:#fff;padding:80px 0}.toggle-container[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]{background:#ffffff1a;border-radius:50px;overflow:hidden}.btn[_ngcontent-%COMP%]{border-radius:50px!important;padding:12px 32px;font-weight:600}.btn-primary[_ngcontent-%COMP%]{background:#667eea;border:none}.plan-card[_ngcontent-%COMP%]{background:#ffffff0d;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:24px;border:1px solid rgba(255,255,255,.1);transition:all .4s ease;overflow:hidden}.plan-card[_ngcontent-%COMP%]:hover{transform:translateY(-15px);box-shadow:0 25px 60px #0006}.plan-card.popular[_ngcontent-%COMP%]{border:2px solid #ff4757;background:#ff47571a}.plan-card.best-value[_ngcontent-%COMP%]{border:2px solid #667eea;background:#667eea1a}.ribbon[_ngcontent-%COMP%]{position:absolute;top:25px;padding:10px 0;width:180px;text-align:center;font-weight:700;color:#fff;font-size:.9rem;z-index:10;text-transform:uppercase}.ribbon-popular[_ngcontent-%COMP%]{right:-55px;background:#ff4757;transform:rotate(45deg)}.ribbon-best[_ngcontent-%COMP%]{right:-60px;background:#667eea;transform:rotate(45deg)}.price[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:4.2rem;font-weight:900;color:#fff}.save-badge[_ngcontent-%COMP%]{background:#ff4757;color:#fff;padding:8px 24px;border-radius:50px;font-weight:700;box-shadow:0 6px 15px #ff475766}.btn-choose[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;font-size:1.1rem;transition:all .3s ease}.btn-choose[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-3px);box-shadow:0 10px 30px #667eea80}.btn-choose[_ngcontent-%COMP%]:disabled{background:#4a4a4a;cursor:not-allowed}.current-plan-banner[_ngcontent-%COMP%]{background:#ffffff1a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2)}"]})}}return i})()}}]);