"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[6353],{6353:(w,b,i)=>{i.r(b),i.d(b,{TeacherDashboardComponent:()=>R});var t=i(4438),u=i(4626),f=i(4337),l=i(177),v=i(9417),F=i(5794),C=i(1413),y=i(6977);const _=["attendanceChart"],O=(a,r,n)=>({"text-success":a,"text-danger":r,"text-warning":n});function D(a,r){if(1&a&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.nI1(5,"date"),t.k0s(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td"),t.EFF(9),t.k0s()()),2&a){const n=r.$implicit;t.R7$(2),t.JRh(n.title||"Untitled"),t.R7$(2),t.JRh(t.i5U(5,4,n.dueDate,"mediumDate")),t.R7$(3),t.JRh((null==n.classId?null:n.classId.name)||"N/A"),t.R7$(2),t.JRh((null==n.subjectId?null:n.subjectId.name)||"N/A")}}function E(a,r){1&a&&(t.j41(0,"tr")(1,"td",43),t.EFF(2,"No pending assignments"),t.k0s()())}function P(a,r){if(1&a&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.nI1(3,"date"),t.k0s(),t.j41(4,"td"),t.EFF(5),t.k0s(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td")(9,"span",44),t.EFF(10),t.k0s()()()),2&a){const n=r.$implicit;t.R7$(2),t.JRh(t.i5U(3,4,n.date,"mediumDate")),t.R7$(3),t.JRh(n.reason||"Not specified"),t.R7$(2),t.JRh(n.leaveType||"N/A"),t.R7$(3),t.JRh(n.status||"Pending")}}function j(a,r){1&a&&(t.j41(0,"tr")(1,"td",43),t.EFF(2,"No pending leave requests"),t.k0s()())}function k(a,r){if(1&a&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.nI1(3,"date"),t.k0s(),t.j41(4,"td"),t.EFF(5),t.k0s(),t.j41(6,"td"),t.EFF(7),t.k0s()()),2&a){const n=r.$implicit;t.R7$(2),t.JRh(t.i5U(3,3,n.date,"mediumDate")),t.R7$(3),t.JRh(n.title||"Untitled"),t.R7$(2),t.JRh(n.description||"No description")}}function M(a,r){1&a&&(t.j41(0,"tr")(1,"td",45),t.EFF(2,"No upcoming holidays"),t.k0s()())}let R=(()=>{class a{constructor(){this.dashboardService=(0,t.WQX)(f.I),this.toastr=(0,t.WQX)(F.tw),this.cdr=(0,t.WQX)(t.gRc),this.destroy$=new C.B,this.teacherDashboardData=null,this.personalAttendanceStatus="Absent",this.pendingAssignmentsCount=0,this.pendingLeavesCount=0,this.upcomingHolidaysCount=0,this.chartOptions={series:[{name:"Present",data:[]},{name:"Absent",data:[]},{name:"Holiday/Sunday",data:[]}],chart:{type:"bar",height:320,stacked:!0,stackType:"100%",toolbar:{show:!1},animations:{enabled:!0},parentHeightOffset:0,zoom:{enabled:!1}},plotOptions:{bar:{horizontal:!1,columnWidth:"70%",borderRadius:8,dataLabels:{position:"top"}}},dataLabels:{enabled:!0,formatter:(n,s)=>{if(2===s.seriesIndex&&1===n){const g=s.w.config.xaxis.categories[s.dataPointIndex],c=new Date;return c.setDate(parseInt(g)),"Sun"===c.toLocaleString("en-US",{weekday:"short"})?"SUN":"HOLI"}return 1===n?"\u25cf":""},offsetY:-25,style:{fontSize:"11px",fontWeight:"bold",colors:["#fff"]},background:{enabled:!0,foreColor:"#000",padding:4,borderRadius:4,borderWidth:0,opacity:.8}},colors:["#28a745","#dc3545","#6c757d"],xaxis:{type:"category",categories:[],labels:{style:{fontSize:"13px",fontWeight:600}},title:{text:"Day of Month",style:{fontWeight:600}}},yaxis:{show:!1},legend:{position:"top",horizontalAlign:"center"},tooltip:{enabled:!1},grid:{show:!1},states:{hover:{filter:{type:"none"}},active:{filter:{type:"none"}}}}}ngOnInit(){this.loadDashboard()}ngAfterViewInit(){this.cdr.detectChanges()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadDashboard(){this.dashboardService.getTeacherDashboard().pipe((0,y.Q)(this.destroy$)).subscribe({next:n=>{if(n?.success&&n.data){const s=n.data;this.teacherDashboardData=s,this.personalAttendanceStatus=s.personalAttendanceStatus||"Absent",this.pendingAssignmentsCount=s.pendingAssignments?.length||0,this.pendingLeavesCount=s.pendingLeaves?.length||0,this.upcomingHolidaysCount=s.upcomingHolidays?.length||0,this.buildTeacherAttendanceChart(s.personalAttendanceStatus,s.monthlyTeacherAttendance||{})}},error:()=>{this.toastr.error("Failed to load dashboard","Error"),this.buildTeacherAttendanceChart("Absent",[])}})}buildTeacherAttendanceChart(n,s){const e=[],o=[],d=[],g=[],c=new Date,m=c.getFullYear(),A=c.getMonth(),x=new Date(m,A+1,0).getDate();for(let h=1;h<=x;h++){g.push(h.toString());const p=s[h];h===c.getDate()?"Present"===n?(e.push(1),o.push(0),d.push(0)):(e.push(0),o.push(1),d.push(0)):"Present"===p?(e.push(1),o.push(0),d.push(0)):"Holiday"===p?(e.push(0),o.push(0),d.push(1)):"Absent"===p?(e.push(0),o.push(1),d.push(0)):(e.push(0),o.push(0),d.push(0))}this.chartOptions={...this.chartOptions,series:[{name:"Present",data:e},{name:"Absent",data:o},{name:"Holiday/Sunday",data:d}],xaxis:{...this.chartOptions.xaxis,categories:g}},this.renderChart()}renderChart(){setTimeout(()=>{this.attendanceChart&&this.attendanceChart.updateOptions(this.chartOptions,!1,!0)},300)}getPendingAssignments(){return this.teacherDashboardData?.pendingAssignments||[]}getPendingLeaves(){return this.teacherDashboardData?.pendingLeaves||[]}getUpcomingHolidays(){return this.teacherDashboardData?.upcomingHolidays||[]}get hasNoPendingAssignments(){return 0===this.pendingAssignmentsCount}get hasNoPendingLeaves(){return 0===this.pendingLeavesCount}get hasNoUpcomingHolidays(){return 0===this.upcomingHolidaysCount}static{this.\u0275fac=function(s){return new(s||a)}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["app-teacher-dashboard"]],viewQuery:function(s,e){if(1&s&&t.GBs(_,5),2&s){let o;t.mGM(o=t.lsd())&&(e.attendanceChart=o.first)}},decls:118,vars:26,consts:[["attendanceChart",""],[1,"dashboard-container","p-3","p-md-4"],[1,"dashboard-header","text-center","mb-4"],[1,"display-6","fw-bold","text-primary"],[1,"text-muted"],[1,"row","g-3","mb-4"],[1,"col-12","col-sm-6","col-md-3"],[1,"card","h-100","shadow-sm","border-0","rounded-4","bg-gradient-light"],[1,"card-body","text-center"],[1,"icon-circle","bg-primary","bg-opacity-10","text-primary","mb-3"],[1,"bi","bi-person-fill",2,"font-size","1.5rem"],[1,"card-title","text-muted"],[1,"fw-bold",3,"ngClass"],[1,"icon-circle","bg-info","bg-opacity-10","text-info","mb-3"],[1,"bi","bi-pencil-fill",2,"font-size","1.5rem"],[1,"fw-bold","text-info"],[1,"icon-circle","bg-warning","bg-opacity-10","text-warning","mb-3"],[1,"bi","bi-calendar-fill",2,"font-size","1.5rem"],[1,"fw-bold","text-warning"],[1,"icon-circle","bg-success","bg-opacity-10","text-success","mb-3"],[1,"bi","bi-gift-fill",2,"font-size","1.5rem"],[1,"fw-bold","text-success"],["id","dashboardAccordion",1,"accordion"],[1,"accordion-item"],[1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#attendanceOverviewCollapse",1,"accordion-button"],["id","attendanceOverviewCollapse","data-bs-parent","#dashboardAccordion",1,"accordion-collapse","collapse","show"],[1,"accordion-body","p-0"],[1,"card","border-0","shadow-sm","rounded-4"],[1,"card-body","p-4"],[3,"series","chart","xaxis","yaxis","plotOptions","dataLabels","colors","legend","tooltip","grid"],["type","button","data-bs-toggle","collapse","data-bs-target","#assignmentsCollapse",1,"accordion-button","collapsed"],["id","assignmentsCollapse","data-bs-parent","#dashboardAccordion",1,"accordion-collapse","collapse"],[1,"card","shadow-sm","border-0","rounded-4"],[1,"table-responsive"],[1,"table","table-hover","table-borderless","mb-0"],[1,"table-light"],[4,"ngFor","ngForOf"],[4,"ngIf"],["type","button","data-bs-toggle","collapse","data-bs-target","#leavesCollapse",1,"accordion-button","collapsed"],["id","leavesCollapse","data-bs-parent","#dashboardAccordion",1,"accordion-collapse","collapse"],["type","button","data-bs-toggle","collapse","data-bs-target","#holidaysCollapse",1,"accordion-button","collapsed"],["id","holidaysCollapse","data-bs-parent","#dashboardAccordion",1,"accordion-collapse","collapse"],["colspan","4",1,"text-center","text-muted","py-4"],[1,"badge","bg-warning","text-dark"],["colspan","3",1,"text-center","text-muted","py-4"]],template:function(s,e){1&s&&(t.j41(0,"div",1)(1,"div",2)(2,"h1",3),t.EFF(3,"Teacher Dashboard"),t.k0s(),t.j41(4,"p",4),t.EFF(5),t.k0s()(),t.j41(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9),t.nrm(11,"i",10),t.k0s(),t.j41(12,"h5",11),t.EFF(13,"My Attendance"),t.k0s(),t.j41(14,"h3",12),t.EFF(15),t.k0s()()()(),t.j41(16,"div",6)(17,"div",7)(18,"div",8)(19,"div",13),t.nrm(20,"i",14),t.k0s(),t.j41(21,"h5",11),t.EFF(22,"Pending Assignments"),t.k0s(),t.j41(23,"h3",15),t.EFF(24),t.k0s()()()(),t.j41(25,"div",6)(26,"div",7)(27,"div",8)(28,"div",16),t.nrm(29,"i",17),t.k0s(),t.j41(30,"h5",11),t.EFF(31,"Pending Leaves"),t.k0s(),t.j41(32,"h3",18),t.EFF(33),t.k0s()()()(),t.j41(34,"div",6)(35,"div",7)(36,"div",8)(37,"div",19),t.nrm(38,"i",20),t.k0s(),t.j41(39,"h5",11),t.EFF(40,"Upcoming Holidays"),t.k0s(),t.j41(41,"h3",21),t.EFF(42),t.k0s()()()()(),t.j41(43,"div",22)(44,"div",23)(45,"h2",24)(46,"button",25),t.EFF(47," My Attendance - Current Month "),t.k0s()(),t.j41(48,"div",26)(49,"div",27)(50,"div",28)(51,"div",29),t.nrm(52,"apx-chart",30,0),t.k0s()()()()(),t.j41(54,"div",23)(55,"h2",24)(56,"button",31),t.EFF(57," Pending Assignments "),t.k0s()(),t.j41(58,"div",32)(59,"div",27)(60,"div",33)(61,"div",34)(62,"table",35)(63,"thead",36)(64,"tr")(65,"th"),t.EFF(66,"Title"),t.k0s(),t.j41(67,"th"),t.EFF(68,"Due Date"),t.k0s(),t.j41(69,"th"),t.EFF(70,"Class"),t.k0s(),t.j41(71,"th"),t.EFF(72,"Subject"),t.k0s()()(),t.j41(73,"tbody"),t.DNE(74,D,10,7,"tr",37)(75,E,3,0,"tr",38),t.k0s()()()()()()(),t.j41(76,"div",23)(77,"h2",24)(78,"button",39),t.EFF(79," Pending Leave Requests "),t.k0s()(),t.j41(80,"div",40)(81,"div",27)(82,"div",33)(83,"div",34)(84,"table",35)(85,"thead",36)(86,"tr")(87,"th"),t.EFF(88,"Date"),t.k0s(),t.j41(89,"th"),t.EFF(90,"Reason"),t.k0s(),t.j41(91,"th"),t.EFF(92,"Type"),t.k0s(),t.j41(93,"th"),t.EFF(94,"Status"),t.k0s()()(),t.j41(95,"tbody"),t.DNE(96,P,11,7,"tr",37)(97,j,3,0,"tr",38),t.k0s()()()()()()(),t.j41(98,"div",23)(99,"h2",24)(100,"button",41),t.EFF(101," Upcoming Holidays "),t.k0s()(),t.j41(102,"div",42)(103,"div",27)(104,"div",33)(105,"div",34)(106,"table",35)(107,"thead",36)(108,"tr")(109,"th"),t.EFF(110,"Date"),t.k0s(),t.j41(111,"th"),t.EFF(112,"Title"),t.k0s(),t.j41(113,"th"),t.EFF(114,"Description"),t.k0s()()(),t.j41(115,"tbody"),t.DNE(116,k,8,6,"tr",37)(117,M,3,0,"tr",38),t.k0s()()()()()()()()()),2&s&&(t.R7$(5),t.SpI("Welcome, ",(null==e.teacherDashboardData||null==e.teacherDashboardData.teacher?null:e.teacherDashboardData.teacher.name)||"Teacher","!"),t.R7$(9),t.Y8G("ngClass",t.sMw(22,O,"Present"===e.personalAttendanceStatus,"Absent"===e.personalAttendanceStatus,"On Leave"===e.personalAttendanceStatus)),t.R7$(),t.JRh(e.personalAttendanceStatus),t.R7$(9),t.JRh(e.pendingAssignmentsCount),t.R7$(9),t.JRh(e.pendingLeavesCount),t.R7$(9),t.JRh(e.upcomingHolidaysCount),t.R7$(10),t.Y8G("series",e.chartOptions.series)("chart",e.chartOptions.chart)("xaxis",e.chartOptions.xaxis)("yaxis",e.chartOptions.yaxis)("plotOptions",e.chartOptions.plotOptions)("dataLabels",e.chartOptions.dataLabels)("colors",e.chartOptions.colors)("legend",e.chartOptions.legend)("tooltip",e.chartOptions.tooltip)("grid",e.chartOptions.grid),t.R7$(22),t.Y8G("ngForOf",e.getPendingAssignments()),t.R7$(),t.Y8G("ngIf",e.hasNoPendingAssignments),t.R7$(21),t.Y8G("ngForOf",e.getPendingLeaves()),t.R7$(),t.Y8G("ngIf",e.hasNoPendingLeaves),t.R7$(19),t.Y8G("ngForOf",e.getUpcomingHolidays()),t.R7$(),t.Y8G("ngIf",e.hasNoUpcomingHolidays))},dependencies:[l.MD,l.YU,l.Sq,l.bT,l.vh,u.J,u.Q,v.YN],styles:[".dashboard-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#f8f9fa}.dashboard-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f1f3f5);padding:1.5rem;border-radius:.5rem;box-shadow:0 2px 10px #0000000d}  .apexcharts-canvas{overflow-x:auto!important;overflow-y:hidden!important;-webkit-overflow-scrolling:touch}  .apexcharts-inner{width:1200px!important}.icon-circle[_ngcontent-%COMP%]{width:3rem;height:3rem;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto}.card[_ngcontent-%COMP%]{transition:transform .3s ease,box-shadow .3s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 4px 20px #0000001a}.bg-gradient-light[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8f9fa)}.accordion-button[_ngcontent-%COMP%]{font-weight:500;color:#333}.accordion-button[_ngcontent-%COMP%]:focus{box-shadow:none;border-color:#dee2e6}.accordion-button[_ngcontent-%COMP%]:not(.collapsed){color:#0d6efd;background-color:#e9ecef}.table[_ngcontent-%COMP%]{font-size:.9rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;text-transform:uppercase;letter-spacing:.5px;white-space:nowrap}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.table[_ngcontent-%COMP%]   .sortable[_ngcontent-%COMP%]{cursor:pointer}.table[_ngcontent-%COMP%]   .sortable[_ngcontent-%COMP%]:hover{background-color:#f1f3f5}.bi[_ngcontent-%COMP%]{font-size:1rem;vertical-align:middle;margin-left:.25rem}@media (max-width: 768px){.dashboard-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.card-body[_ngcontent-%COMP%]{padding:1rem}.icon-circle[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem}.accordion-button[_ngcontent-%COMP%]{font-size:.9rem;padding:.75rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.85rem;padding:.5rem}}"]})}}return a})()}}]);