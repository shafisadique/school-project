"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[6817],{6817:(v,g,r)=>{r.r(g),r.d(g,{StudentTimetableComponent:()=>y});var s=r(177),l=r(9417),p=r(8359),m=r(980),e=r(4438),b=r(165),_=r(5794);function h(a,o){if(1&a&&(e.j41(0,"option",13),e.EFF(1),e.k0s()),2&a){const t=o.$implicit;e.Y8G("value",t._id),e.R7$(),e.SpI(" ",t.name," ")}}function C(a,o){1&a&&(e.j41(0,"div",14),e.nrm(1,"div",15),e.j41(2,"p"),e.EFF(3,"Loading your timetable..."),e.k0s()())}function f(a,o){1&a&&(e.j41(0,"div",16),e.nrm(1,"i",17),e.j41(2,"h3"),e.EFF(3,"No Timetable Found"),e.k0s(),e.j41(4,"p"),e.EFF(5,"Your class schedule has not been assigned for the selected year."),e.k0s()())}function O(a,o){if(1&a&&(e.j41(0,"th",32)(1,"div",33),e.EFF(2),e.k0s(),e.j41(3,"small"),e.EFF(4),e.k0s()()),2&a){const t=o.$implicit;e.R7$(2),e.JRh(t.start),e.R7$(2),e.SpI("to ",t.end,"")}}function M(a,o){1&a&&(e.j41(0,"div",38),e.EFF(1,"Today"),e.k0s())}function P(a,o){if(1&a&&(e.qex(0),e.j41(1,"div",41),e.EFF(2),e.k0s(),e.j41(3,"div",42),e.EFF(4),e.k0s(),e.j41(5,"div",43),e.EFF(6),e.k0s(),e.bVm()),2&a){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.subject),e.R7$(2),e.JRh(t.teacher),e.R7$(2),e.JRh(t.room||"\u2014")}}function u(a,o){1&a&&(e.j41(0,"span",44),e.EFF(1,"\u2014"),e.k0s())}function w(a,o){if(1&a&&(e.j41(0,"td",39),e.DNE(1,P,7,3,"ng-container",40)(2,u,2,0,"ng-template",null,0,e.C5r),e.k0s()),2&a){const t=o.$implicit,n=e.sdS(3);e.AVh("break-cell",!t)("has-class",t),e.R7$(),e.Y8G("ngIf",t)("ngIfElse",n)}}function x(a,o){if(1&a&&(e.j41(0,"tr")(1,"td",34)(2,"div",35),e.EFF(3),e.k0s(),e.DNE(4,M,2,0,"div",36),e.k0s(),e.DNE(5,w,4,6,"td",37),e.k0s()),2&a){const t=o.$implicit,n=o.index,i=e.XpG(2);e.AVh("weekend-row",i.isWeekend(t)),e.R7$(3),e.JRh(t),e.R7$(),e.Y8G("ngIf",i.isToday(t)),e.R7$(),e.Y8G("ngForOf",i.grid[n])}}function k(a,o){if(1&a&&(e.j41(0,"div",18)(1,"div",19)(2,"h4"),e.nrm(3,"i",20),e.EFF(4,"Weekly Schedule"),e.k0s(),e.j41(5,"div",21)(6,"span",22),e.nrm(7,"span",23),e.EFF(8," Weekend"),e.k0s(),e.j41(9,"span",22),e.nrm(10,"span",24),e.EFF(11," Break / Free"),e.k0s()()(),e.j41(12,"div",25)(13,"table",26)(14,"thead")(15,"tr")(16,"th",27),e.EFF(17,"Day"),e.k0s(),e.DNE(18,O,5,2,"th",28),e.k0s()(),e.j41(19,"tbody"),e.DNE(20,x,6,5,"tr",29),e.k0s()()(),e.j41(21,"div",30)(22,"small"),e.nrm(23,"i",31),e.EFF(24," Timetable auto-updates when teachers make changes "),e.k0s()()()),2&a){const t=e.XpG();e.R7$(18),e.Y8G("ngForOf",t.timeSlots),e.R7$(2),e.Y8G("ngForOf",t.days)}}let y=(()=>{class a{constructor(t,n){this.timetableService=t,this.toastr=n,this.timetable=[],this.grid=[],this.timeSlots=[],this.days=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],this.academicYears=[],this.selectedYearId="",this.schoolId=localStorage.getItem("schoolId")||"",this.isLoading=!1,this.subscriptions=new p.yU}ngOnInit(){this.loadAcademicYears()}ngOnDestroy(){this.subscriptions.unsubscribe()}loadAcademicYears(){this.isLoading=!0;const t=this.timetableService.getAcademicYears(this.schoolId).pipe((0,m.j)(()=>this.isLoading=!1)).subscribe({next:n=>{this.academicYears=n,this.selectActiveAcademicYear()},error:()=>this.toastr.error("Failed to load academic years")});this.subscriptions.add(t)}selectActiveAcademicYear(){const t=this.timetableService.getActiveAcademicYear(this.schoolId).subscribe({next:n=>{const i=n?._id;this.academicYears.some(c=>c._id===i)?this.selectedYearId=i:this.academicYears.length>0&&(this.selectedYearId=this.academicYears[0]._id),this.selectedYearId&&this.loadTimetable()},error:()=>{this.academicYears.length>0&&(this.selectedYearId=this.academicYears[0]._id,this.loadTimetable())}});this.subscriptions.add(t)}loadTimetable(){if(!this.selectedYearId)return;this.isLoading=!0;const t=this.timetableService.getStudentTimetable(this.selectedYearId).pipe((0,m.j)(()=>this.isLoading=!1)).subscribe({next:n=>{this.timetable=n||[],this.buildGrid()},error:()=>this.toastr.error("Failed to load timetable")});this.subscriptions.add(t)}onYearChange(){this.loadTimetable()}buildGrid(){const t=new Set;this.timetable.forEach(n=>{t.add(`${n.startTime}-${n.endTime}`)}),this.timeSlots=Array.from(t).map(n=>{const[i,d]=n.split("-");return{start:i,end:d}}).sort((n,i)=>n.start.localeCompare(i.start)),this.grid=this.days.map(()=>Array(this.timeSlots.length).fill(null)),this.timetable.forEach(n=>{const i=this.days.indexOf(n.day),d=this.timeSlots.findIndex(c=>c.start===n.startTime&&c.end===n.endTime);-1!==i&&-1!==d&&(this.grid[i][d]={subject:n.subjectId?.name||"Unknown Subject",teacher:n.teacherId?.name||"TBD",room:n.room||""})})}isWeekend(t){return"Saturday"===t||"Sunday"===t}isToday(t){return t===(new Date).toLocaleString("en-us",{weekday:"long"})}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(b.n),e.rXU(_.tw))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-student-timetable"]],decls:16,vars:6,consts:[["breakSlot",""],[1,"timetable-wrapper"],[1,"page-header"],[1,"header-content"],[1,"page-title"],[1,"page-subtitle"],[1,"header-actions"],[1,"form-select","modern-select",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"badge-modern","bg-gradient-primary"],["class","loading-state",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","timetable-card",4,"ngIf"],[3,"value"],[1,"loading-state"],[1,"spinner-large"],[1,"empty-state"],[1,"bi","bi-calendar-x","display-1","text-muted","opacity-50"],[1,"timetable-card"],[1,"timetable-header"],[1,"bi","bi-clock-history","me-2"],[1,"legend"],[1,"legend-item"],[1,"dot","weekend"],[1,"dot","break"],[1,"table-responsive"],[1,"timetable-table"],[1,"day-header"],["class","slot-header",4,"ngFor","ngForOf"],[3,"weekend-row",4,"ngFor","ngForOf"],[1,"timetable-footer"],[1,"bi","bi-info-circle-fill","me-1"],[1,"slot-header"],[1,"time"],[1,"day-cell"],[1,"day-name"],["class","date-hint",4,"ngIf"],["class","period-cell",3,"break-cell","has-class",4,"ngFor","ngForOf"],[1,"date-hint"],[1,"period-cell"],[4,"ngIf","ngIfElse"],[1,"subject"],[1,"teacher"],[1,"room-badge"],[1,"break-text"]],template:function(n,i){1&n&&(e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"h1",4),e.EFF(5,"My Class Timetable"),e.k0s(),e.j41(6,"p",5),e.EFF(7,"View your complete weekly schedule"),e.k0s()(),e.j41(8,"div",6)(9,"select",7),e.mxI("ngModelChange",function(c){return e.DH7(i.selectedYearId,c)||(i.selectedYearId=c),c}),e.bIt("change",function(){return i.onYearChange()}),e.DNE(10,h,2,2,"option",8),e.k0s(),e.j41(11,"div",9),e.EFF(12),e.k0s()()()(),e.DNE(13,C,4,0,"div",10)(14,f,6,0,"div",11)(15,k,25,2,"div",12),e.k0s()),2&n&&(e.R7$(9),e.R50("ngModel",i.selectedYearId),e.R7$(),e.Y8G("ngForOf",i.academicYears),e.R7$(2),e.SpI(" ",i.timetable.length," Periods "),e.R7$(),e.Y8G("ngIf",i.isLoading),e.R7$(),e.Y8G("ngIf",!i.isLoading&&0===i.timetable.length),e.R7$(),e.Y8G("ngIf",!i.isLoading&&i.timetable.length>0))},dependencies:[s.MD,s.Sq,s.bT,l.YN,l.xH,l.y7,l.wz,l.BC,l.vS],styles:['@import"https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap";.timetable-wrapper[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;background:linear-gradient(135deg,#f5f7fa,#c3cfe2);min-height:100vh;padding:1.5rem}.timetable-wrapper[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.timetable-wrapper[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;background:#fffffff2;padding:1.8rem 2rem;border-radius:20px;box-shadow:0 10px 30px #0000001f;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.3)}.timetable-wrapper[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;margin:0}.timetable-wrapper[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{color:#64748b;margin:.5rem 0 0;font-size:1rem}.timetable-wrapper[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.timetable-wrapper[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .modern-select[_ngcontent-%COMP%]{border-radius:50px;padding:.6rem 1.4rem;font-weight:500;border:2px solid #e2e8f0;background:#fff;min-width:180px;box-shadow:0 4px 15px #0000000d}.timetable-wrapper[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .badge-modern[_ngcontent-%COMP%]{padding:.6rem 1.2rem;border-radius:50px;font-weight:600;font-size:.9rem;color:#fff;background:linear-gradient(135deg,#667eea,#764ba2);box-shadow:0 4px 15px #667eea66}.timetable-wrapper[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%], .timetable-wrapper[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem}.timetable-wrapper[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]   .spinner-large[_ngcontent-%COMP%], .timetable-wrapper[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .spinner-large[_ngcontent-%COMP%]{width:4rem;height:4rem;border:5px solid #f3f4f6;border-top:5px solid #667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;overflow:hidden;box-shadow:0 10px 30px #0000001f;border:1px solid #e2e8f0}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-header[_ngcontent-%COMP%]{padding:1.5rem 2rem;background:linear-gradient(135deg,#2c3e50,#34495e);color:#fff;display:flex;justify-content:space-between;align-items:center}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-weight:600;color:#fff}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-header[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{display:flex;gap:1rem;font-size:.9rem}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-header[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-header[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-header[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.weekend[_ngcontent-%COMP%]{background:#fbbf24}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-header[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .dot.break[_ngcontent-%COMP%]{background:#e5e7eb}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]{margin:0}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1e293b,#334155);color:#fff;text-align:center;font-weight:600;font-size:.85rem;padding:1rem;text-transform:uppercase;letter-spacing:.8px}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.day-header[_ngcontent-%COMP%]{background:#1e293b;position:sticky;left:0;z-index:10;width:130px}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   .day-cell[_ngcontent-%COMP%]{background:#f8fafc;font-weight:700;color:#1e293b;text-align:center;position:sticky;left:0;z-index:9}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   .day-cell[_ngcontent-%COMP%]   .date-hint[_ngcontent-%COMP%]{font-size:.7rem;color:#10b981;font-weight:600;margin-top:4px}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   .period-cell[_ngcontent-%COMP%]{min-height:110px;vertical-align:middle;text-align:center;padding:1rem .5rem;border:1px solid #e2e8f0;transition:all .3s ease}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   .period-cell.break-cell[_ngcontent-%COMP%]{background:repeating-linear-gradient(45deg,#f8fafc,#f8fafc 10px,#f1f5f9 10px 20px)}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   .period-cell.has-class[_ngcontent-%COMP%]:hover{background:#eef2ff;transform:scale(1.05);box-shadow:0 8px 25px #667eea26;z-index:5}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   .period-cell[_ngcontent-%COMP%]   .subject[_ngcontent-%COMP%]{font-weight:700;color:#1e293b;font-size:.95rem}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   .period-cell[_ngcontent-%COMP%]   .teacher[_ngcontent-%COMP%]{font-size:.8rem;color:#64748b;margin:4px 0}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   .period-cell[_ngcontent-%COMP%]   .room-badge[_ngcontent-%COMP%]{display:inline-block;background:linear-gradient(135deg,#6366f1,#8b5cf6);color:#fff;padding:4px 10px;border-radius:50px;font-size:.75rem;font-weight:600}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   .period-cell[_ngcontent-%COMP%]   .break-text[_ngcontent-%COMP%]{color:#94a3b8;font-size:1.5rem}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   .weekend-row[_ngcontent-%COMP%]{background:linear-gradient(90deg,#fffbeb,#fef3c7)!important;opacity:.95}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-card[_ngcontent-%COMP%]   .timetable-footer[_ngcontent-%COMP%]{padding:1rem 2rem;background:#f8fafc;border-top:1px solid #e2e8f0;text-align:center;color:#64748b;font-size:.9rem}@media (max-width: 768px){.timetable-wrapper[_ngcontent-%COMP%]{padding:1rem}.timetable-wrapper[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.timetable-wrapper[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{margin-top:1rem}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.timetable-wrapper[_ngcontent-%COMP%]   .timetable-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:1rem;border-radius:16px;overflow:hidden;box-shadow:0 4px 15px #00000014}.timetable-wrapper[_ngcontent-%COMP%]   .day-cell[_ngcontent-%COMP%], .timetable-wrapper[_ngcontent-%COMP%]   .period-cell[_ngcontent-%COMP%]{display:block;text-align:center;padding:1rem}}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}']})}}return a})()}}]);