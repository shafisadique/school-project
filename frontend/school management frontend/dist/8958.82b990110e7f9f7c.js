"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[8958],{3891:(I,C,r)=>{r.d(C,{e:()=>P});var d=r(1626),p=r(2525),m=r(4438);let P=(()=>{class _{constructor(a){this.http=a,this.apiUrl=p.c.apiUrl}getClassesBySchool(a){return this.http.get(`${this.apiUrl}/api/class-subject-management/classes/${a}`)}getStudentsByClass(a,t){const g=`${this.apiUrl}/api/students/get-student-by-class/${a}`,u=(new d.Nl).set("academicYearId",t);return this.http.get(g,{params:u})}assignRollNumbers(a){return this.http.post(`${this.apiUrl}/api/students/assign-roll-numbers?classId=${a}`,{})}assignRollNumbersAlphabetically(a){return this.http.post(`${this.apiUrl}/api/students/assign-roll-numbers-alphabetically?classId=${a}`,{})}assignRollNumberToStudent(a,t){return this.http.put(`${this.apiUrl}/api/students/${a}/assign-roll-number`,{rollNo:t})}createClass(a){return this.http.post(`${this.apiUrl}/api/class-subject-management/classes`,a)}deleteAssignment(a){return this.http.delete(`${this.apiUrl}/api/class-subject-management/assign-subject`,{body:a})}createSubject(a){return this.http.post(`${this.apiUrl}/api/class-subject-management/subject`,a)}getSubjects(a){return this.http.get(`${this.apiUrl}/api/class-subject-management/subjects/${a}`)}getTeachers(a){return this.http.get(`${this.apiUrl}/api/class-subject-management/teachers/by-school/${a}`)}getCombinedAssignments(a,t){const g=(new d.Nl).set("academicYearId",t);return this.http.get(`${this.apiUrl}/api/class-subject-management/assignments/${a}`,{params:g})}assignSubjectToClass(a,t,g,u){return this.http.post(`${this.apiUrl}/api/class-subject-management/assign-subject`,{classId:a,subjectId:t,teacherId:g,academicYearId:u})}updateAssignment(a){return this.http.put(`${this.apiUrl}/api/class-subject-management/assign-subject`,a)}getAssignmentsByTeacher(a,t,g){let u=(new d.Nl).set("academicYearId",t);return g&&(u=u.set("date",g)),this.http.get(`${this.apiUrl}/api/class-subject-management/assignments/teacher/${a}`,{params:u})}updateAttendanceTeachers(a,t,g){return this.http.put(`${this.apiUrl}/api/class-subject-management/update-attendance-teachers`,{classId:a,attendanceTeacher:t,substituteAttendanceTeachers:g})}getTeacherAttendanceClasses(){return this.http.get(`${this.apiUrl}/api/class-subject-management/teacher-classes`)}static{this.\u0275fac=function(t){return new(t||_)(m.KVO(d.Qq))}}static{this.\u0275prov=m.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}}return _})()},8958:(I,C,r)=>{r.r(C),r.d(C,{BulkInvoiceListComponent:()=>gt});var d=r(177),p=r(9417),m=r(3323),P=r(1413),_=r(6977),O=r(152),a=r(3294),t=r(4438),g=r(2329),u=r(6561),v=r(3891),y=r(998),k=r(5794),h=r(749);const x=["searchInput"],w=o=>({active:o}),F=o=>({"text-danger":o}),E=(o,c,n,i)=>({"bg-success":o,"bg-warning":c,"bg-info":n,"bg-danger":i}),j=(o,c,n)=>({"bg-success":o,"bg-info":c,"bg-warning":n}),R=(o,c,n)=>({"text-success":o,"text-warning":c,"text-danger":n}),D=o=>({"text-danger fw-bold":o});function $(o,c){if(1&o&&(t.j41(0,"option",35),t.EFF(1),t.k0s()),2&o){const n=c.$implicit;t.Y8G("value",n.id),t.R7$(),t.JRh(n.name)}}function B(o,c){if(1&o&&(t.j41(0,"span",47),t.EFF(1),t.k0s()),2&o){const n=t.XpG().$implicit;t.R7$(),t.SpI("(",n.admissionNo,")")}}function S(o,c){if(1&o){const n=t.RV6();t.j41(0,"li",44),t.bIt("click",function(){const e=t.eBV(n).$implicit,s=t.XpG(3);return t.Njj(s.selectStudentFromList(e))}),t.j41(1,"span",45),t.EFF(2),t.k0s(),t.DNE(3,B,2,1,"span",46),t.k0s()}if(2&o){const n=c.$implicit;t.R7$(2),t.JRh(n.name),t.R7$(),t.Y8G("ngIf",n.admissionNo)}}function T(o,c){if(1&o&&(t.j41(0,"div",42)(1,"ul"),t.DNE(2,S,4,2,"li",43),t.k0s()()),2&o){const n=t.XpG(2);t.R7$(2),t.Y8G("ngForOf",n.searchResults)("ngForTrackBy",n.trackByStudentId)}}function L(o,c){1&o&&(t.j41(0,"small",48),t.EFF(1," No students found "),t.k0s())}function U(o,c){if(1&o){const n=t.RV6();t.j41(0,"div",36)(1,"label",37),t.EFF(2,"Student"),t.k0s(),t.j41(3,"input",38,0),t.mxI("ngModelChange",function(e){t.eBV(n);const s=t.XpG();return t.DH7(s.searchQuery,e)||(s.searchQuery=e),t.Njj(e)}),t.bIt("input",function(e){t.eBV(n);const s=t.XpG();return t.Njj(s.searchStudents(e))}),t.k0s(),t.nrm(5,"i",39),t.DNE(6,T,3,2,"div",40)(7,L,2,0,"small",41),t.k0s()}if(2&o){const n=t.XpG();t.R7$(3),t.R50("ngModel",n.searchQuery),t.R7$(3),t.Y8G("ngIf",n.showDropdown),t.R7$(),t.Y8G("ngIf",0===n.searchResults.length&&n.queryLength>=2)}}function G(o,c){if(1&o&&(t.j41(0,"div",49)(1,"h2"),t.EFF(2),t.k0s()()),2&o){const n=t.XpG();t.R7$(2),t.Lme("Invoices for ","class"===n.viewMode?n.selectedClassName:(null==n.selectedStudent?null:n.selectedStudent.name)||"Selected Student"," - ",n.month,"")}}function Y(o,c){if(1&o){const n=t.RV6();t.j41(0,"button",72),t.bIt("click",function(){t.eBV(n);const e=t.XpG().$implicit,s=t.XpG(2);return t.Njj(s.processPayment(e._id,e.remainingDue))}),t.nrm(1,"i",73),t.k0s()}if(2&o){const n=t.XpG().$implicit;t.BMQ("aria-label","Process payment for "+((null==n.studentId?null:n.studentId.name)||"Unknown"))}}function N(o,c){if(1&o){const n=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td",57)(4,"div",58)(5,"div",59),t.EFF(6),t.k0s(),t.j41(7,"span",60),t.EFF(8),t.k0s()()(),t.j41(9,"td",61),t.EFF(10),t.nI1(11,"currency"),t.k0s(),t.j41(12,"td",62),t.EFF(13),t.nI1(14,"currency"),t.k0s(),t.j41(15,"td",63)(16,"span",64),t.EFF(17),t.k0s()(),t.j41(18,"td",65),t.EFF(19),t.nI1(20,"date"),t.k0s(),t.j41(21,"td",66)(22,"button",67),t.bIt("click",function(){const e=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.downloadInvoicePDF(e._id))}),t.nrm(23,"i",68),t.k0s(),t.DNE(24,Y,2,1,"button",69),t.j41(25,"button",70),t.bIt("click",function(){const e=t.eBV(n).$implicit,s=t.XpG(2);return t.Njj(s.openStudentView((null==e.studentId?null:e.studentId._id)||(null==e.student?null:e.student._id),(null==e.studentId?null:e.studentId.name)||(null==e.student?null:e.student.name)))}),t.nrm(26,"i",71),t.k0s()()()}if(2&o){const n=c.$implicit,i=c.index,e=t.XpG(2);t.R7$(2),t.JRh((e.currentPage-1)*e.pageSize+i+1),t.R7$(3),t.BMQ("aria-label","Avatar for "+((null==n.studentId?null:n.studentId.name)||"Unknown")),t.R7$(),t.SpI(" ",e.getInitials((null==n.studentId?null:n.studentId.name)||"Unknown")," "),t.R7$(2),t.JRh((null==n.studentId?null:n.studentId.name)||"Unknown Student"),t.R7$(2),t.JRh(t.i5U(11,14,n.totalAmount,"INR")),t.R7$(2),t.Y8G("ngClass",t.eq3(23,F,n.remainingDue>0)),t.R7$(),t.JRh(t.i5U(14,17,n.remainingDue,"INR")),t.R7$(3),t.Y8G("ngClass",t.ziG(25,E,"Paid"===n.status,"Pending"===n.status,"Partial"===n.status,"Overdue"===n.status)),t.BMQ("aria-label","Invoice status: "+n.status),t.R7$(),t.SpI(" ",n.status," "),t.R7$(2),t.JRh(t.i5U(20,20,n.dueDate,"dd-MMM-yyyy")),t.R7$(3),t.BMQ("aria-label","Download invoice for "+((null==n.studentId?null:n.studentId.name)||"Unknown")),t.R7$(2),t.Y8G("ngIf","Paid"!==n.status),t.R7$(),t.BMQ("aria-label","View all invoices for "+((null==n.studentId?null:n.studentId.name)||"Unknown"))}}function A(o,c){1&o&&(t.j41(0,"tr",74)(1,"td",75),t.EFF(2,"No invoices found for the selected criteria."),t.k0s()())}function z(o,c){if(1&o&&(t.j41(0,"div",50)(1,"div",51)(2,"table",52)(3,"thead")(4,"tr")(5,"th",53),t.EFF(6,"#"),t.k0s(),t.j41(7,"th",53),t.EFF(8,"Student"),t.k0s(),t.j41(9,"th",53),t.EFF(10,"Total Amount"),t.k0s(),t.j41(11,"th",53),t.EFF(12,"Remaining Due"),t.k0s(),t.j41(13,"th",53),t.EFF(14,"Status"),t.k0s(),t.j41(15,"th",53),t.EFF(16,"Due Date"),t.k0s(),t.j41(17,"th",54),t.EFF(18,"Download/Pay/Invoice"),t.k0s()()(),t.j41(19,"tbody"),t.DNE(20,N,27,30,"tr",55)(21,A,3,0,"tr",56),t.k0s()()()()),2&o){const n=t.XpG();t.R7$(20),t.Y8G("ngForOf",n.filteredInvoices)("ngForTrackBy",n.trackByInvoiceId),t.R7$(),t.Y8G("ngIf",0===n.filteredInvoices.length&&n.selectedClassId&&n.month)}}function X(o,c){if(1&o&&(t.j41(0,"option",86),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&o){const n=c.$implicit;t.Y8G("ngValue",n),t.R7$(),t.E5c(" ",n.academicYearName," (",n.ledger.length," months | Due: ",t.i5U(2,4,n.summary.totalDue,"INR"),") ")}}function V(o,c){if(1&o){const n=t.RV6();t.j41(0,"div",82)(1,"label",83),t.EFF(2,"Select Academic Year"),t.k0s(),t.j41(3,"select",84),t.mxI("ngModelChange",function(e){t.eBV(n);const s=t.XpG(2);return t.DH7(s.selectedLedger,e)||(s.selectedLedger=e),t.Njj(e)}),t.bIt("change",function(){t.eBV(n);const e=t.XpG(2);return t.Njj(e.onAcademicYearChange())}),t.DNE(4,X,3,7,"option",85),t.k0s()()}if(2&o){const n=t.XpG(2);t.R7$(3),t.R50("ngModel",n.selectedLedger),t.R7$(),t.Y8G("ngForOf",n.ledgers)("ngForTrackBy",n.trackByLedgerId)}}function H(o,c){if(1&o&&(t.j41(0,"div",87)(1,"div",88)(2,"div",89),t.nrm(3,"i",90),t.j41(4,"h6",91),t.EFF(5,"Total Paid"),t.k0s(),t.j41(6,"p",92),t.EFF(7),t.nI1(8,"currency"),t.k0s()(),t.j41(9,"div",89),t.nrm(10,"i",93),t.j41(11,"h6",94),t.EFF(12,"Total Due"),t.k0s(),t.j41(13,"p",92),t.EFF(14),t.nI1(15,"currency"),t.k0s()(),t.j41(16,"div",89),t.nrm(17,"i",95),t.j41(18,"h6",96),t.EFF(19,"Months Paid"),t.k0s(),t.j41(20,"p",92),t.EFF(21),t.k0s()(),t.j41(22,"div",89),t.nrm(23,"i",97),t.j41(24,"h6",98),t.EFF(25,"Overdue"),t.k0s(),t.j41(26,"p",99),t.EFF(27),t.k0s()()()()),2&o){const n=t.XpG(2);t.R7$(7),t.JRh(t.i5U(8,5,n.summary.totalPaid,"INR")),t.R7$(7),t.JRh(t.i5U(15,8,n.summary.totalDue,"INR")),t.R7$(7),t.Lme("",n.summary.monthsWithPayments," / ",n.summary.totalMonths,""),t.R7$(6),t.JRh(n.summary.overdueMonths||0)}}function Q(o,c){if(1&o){const n=t.RV6();t.j41(0,"div",82)(1,"button",100),t.bIt("click",function(){t.eBV(n);const e=t.XpG(2);return t.Njj(e.togglePaymentHistory())}),t.nrm(2,"i",101),t.EFF(3),t.k0s()()}if(2&o){const n=t.XpG(2);t.R7$(),t.BMQ("aria-expanded",n.showPaymentHistory),t.R7$(2),t.Lme(" ",n.showPaymentHistory?"Hide":"Show"," Payment History (",n.overallPayments.length," payments) ")}}function K(o,c){if(1&o&&(t.j41(0,"span",120),t.EFF(1),t.k0s()),2&o){const n=t.XpG().$implicit;t.R7$(),t.SpI(" ",n.transactionId," ")}}function W(o,c){if(1&o&&(t.j41(0,"span",121),t.EFF(1),t.k0s()),2&o){const n=t.XpG().$implicit;t.R7$(),t.SpI(" ",n.chequeNumber," ")}}function J(o,c){1&o&&(t.j41(0,"span",122),t.EFF(1," N/A "),t.k0s())}function Z(o,c){if(1&o&&(t.j41(0,"tr")(1,"td",106),t.EFF(2),t.k0s(),t.j41(3,"td",107),t.EFF(4),t.nI1(5,"date"),t.j41(6,"small",108),t.EFF(7),t.nI1(8,"date"),t.k0s()(),t.j41(9,"td",109),t.EFF(10),t.nI1(11,"currency"),t.k0s(),t.j41(12,"td",110)(13,"span",111),t.EFF(14),t.k0s()(),t.j41(15,"td",112),t.DNE(16,K,2,1,"span",113)(17,W,2,1,"span",114)(18,J,2,0,"span",115),t.k0s(),t.j41(19,"td",116)(20,"span",117),t.EFF(21),t.k0s()(),t.j41(22,"td",118),t.EFF(23),t.k0s(),t.j41(24,"td",119),t.EFF(25),t.nI1(26,"currency"),t.k0s()()),2&o){const n=c.$implicit,i=c.index,e=t.XpG(3);t.R7$(2),t.JRh(i+1),t.R7$(2),t.SpI(" ",t.i5U(5,14,n.date,"dd-MMM-yyyy")," "),t.R7$(3),t.JRh(t.i5U(8,17,n.date,"h:mm a")),t.R7$(3),t.SpI(" ",t.i5U(11,20,n.amount,"INR")," "),t.R7$(3),t.Y8G("ngClass",t.sMw(26,j,"Cash"===n.paymentMethod,"Online"===n.paymentMethod,"Cheque"===n.paymentMethod)),t.BMQ("aria-label","Payment method: "+n.paymentMethod),t.R7$(),t.SpI(" ",n.paymentMethod," "),t.R7$(2),t.Y8G("ngIf",n.transactionId),t.R7$(),t.Y8G("ngIf",n.chequeNumber),t.R7$(),t.Y8G("ngIf",!n.transactionId&&!n.chequeNumber),t.R7$(3),t.SpI(" ",n.invoiceMonth," "),t.R7$(2),t.SpI(" ",n.processedBy," "),t.R7$(),t.Y8G("ngClass",t.sMw(30,R,0===e.getBalanceAfter(i),e.getBalanceAfter(i)>0&&e.getBalanceAfter(i)<=1e3,e.getBalanceAfter(i)>1e3)),t.R7$(),t.SpI(" ",t.i5U(26,23,e.getBalanceAfter(i),"INR")," ")}}function q(o,c){if(1&o&&(t.j41(0,"div",102)(1,"h5"),t.nrm(2,"i",103),t.EFF(3),t.k0s(),t.j41(4,"div",51)(5,"table",104)(6,"thead",105)(7,"tr")(8,"th",53),t.EFF(9,"#"),t.k0s(),t.j41(10,"th",53),t.EFF(11,"Date & Time"),t.k0s(),t.j41(12,"th",53),t.EFF(13,"Amount"),t.k0s(),t.j41(14,"th",53),t.EFF(15,"Method"),t.k0s(),t.j41(16,"th",53),t.EFF(17,"Reference"),t.k0s(),t.j41(18,"th",53),t.EFF(19,"Invoice Month"),t.k0s(),t.j41(20,"th",53),t.EFF(21,"Processed By"),t.k0s(),t.j41(22,"th",53),t.EFF(23,"Balance After"),t.k0s()()(),t.j41(24,"tbody"),t.DNE(25,Z,27,34,"tr",55),t.k0s()()()()),2&o){const n=t.XpG(2);t.R7$(3),t.SpI(" Payment History for ",null==n.selectedStudent?null:n.selectedStudent.name," "),t.R7$(22),t.Y8G("ngForOf",n.overallPayments)("ngForTrackBy",n.trackByPaymentId)}}function tt(o,c){1&o&&(t.j41(0,"div",123),t.nrm(1,"i",124),t.EFF(2," No payment history found for this student. "),t.k0s())}function nt(o,c){1&o&&(t.j41(0,"small",108),t.EFF(1,"Carry from last"),t.k0s())}function et(o,c){if(1&o&&(t.j41(0,"small",108),t.EFF(1),t.k0s()),2&o){const n=t.XpG().$implicit;t.R7$(),t.SpI("(",n.payments.length," receipts)")}}function ot(o,c){if(1&o){const n=t.RV6();t.j41(0,"button",140),t.nI1(1,"currency"),t.bIt("click",function(){t.eBV(n);const e=t.XpG().$implicit,s=t.XpG(3);return t.Njj(s.processPayment(e._id,e.remainingDue))}),t.nrm(2,"i",141),t.EFF(3,"Pay "),t.k0s()}if(2&o){const n=t.XpG().$implicit;t.BMQ("aria-label","Process payment of "+t.i5U(1,1,n.remainingDue,"INR")+" for "+n.month)}}function it(o,c){if(1&o){const n=t.RV6();t.j41(0,"tr",127)(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td",128),t.EFF(4),t.k0s(),t.j41(5,"td",129),t.EFF(6),t.nI1(7,"currency"),t.DNE(8,nt,2,0,"small",130),t.k0s(),t.j41(9,"td",131),t.EFF(10),t.nI1(11,"currency"),t.k0s(),t.j41(12,"td",132),t.EFF(13),t.nI1(14,"currency"),t.k0s(),t.j41(15,"td",133),t.EFF(16),t.nI1(17,"currency"),t.DNE(18,et,2,1,"small",130),t.k0s(),t.j41(19,"td",134),t.EFF(20),t.nI1(21,"currency"),t.k0s(),t.j41(22,"td",63)(23,"span",135),t.EFF(24),t.k0s()(),t.j41(25,"td",136),t.EFF(26),t.nI1(27,"date"),t.k0s(),t.j41(28,"td",66)(29,"button",137),t.bIt("click",function(){const e=t.eBV(n).$implicit,s=t.XpG(3);return t.Njj(s.downloadInvoicePDF(e._id))}),t.nrm(30,"i",138),t.EFF(31,"Download "),t.k0s(),t.DNE(32,ot,4,4,"button",139),t.k0s()()}if(2&o){const n=c.$implicit,i=c.index,e=t.XpG(3);t.Y8G("ngClass",e.getRowClass(n.status)),t.R7$(2),t.JRh(i+1),t.R7$(2),t.JRh(n.month),t.R7$(),t.Y8G("ngClass",t.eq3(36,D,n.previousDue>0)),t.R7$(),t.SpI(" ",t.i5U(7,18,n.previousDue,"INR")," "),t.R7$(2),t.Y8G("ngIf",n.previousDue>0),t.R7$(2),t.JRh(t.i5U(11,21,n.currentFee,"INR")),t.R7$(3),t.JRh(t.i5U(14,24,n.totalDues,"INR")),t.R7$(3),t.SpI(" ",t.i5U(17,27,n.paidAmount,"INR")," "),t.R7$(2),t.Y8G("ngIf",(null==n.payments?null:n.payments.length)>0),t.R7$(),t.Y8G("ngClass",t.eq3(38,F,n.remainingDue>0)),t.R7$(),t.SpI(" ",t.i5U(21,30,n.remainingDue,"INR")," "),t.R7$(3),t.Y8G("ngClass",e.getStatusClass(n.status)),t.BMQ("aria-label","Invoice status: "+n.status),t.R7$(),t.SpI(" ",n.status," "),t.R7$(2),t.JRh(t.i5U(27,33,n.dueDate,"dd-MMM-yyyy")),t.R7$(3),t.BMQ("aria-label","Download invoice for "+n.month),t.R7$(3),t.Y8G("ngIf",n.remainingDue>0)}}function at(o,c){if(1&o&&(t.j41(0,"div",51)(1,"table",125)(2,"thead",105)(3,"tr")(4,"th",53),t.EFF(5,"#"),t.k0s(),t.j41(6,"th",53),t.EFF(7,"Month"),t.k0s(),t.j41(8,"th",53),t.EFF(9,"Previous Dues"),t.k0s(),t.j41(10,"th",53),t.EFF(11,"Current Fee"),t.k0s(),t.j41(12,"th",53),t.EFF(13,"Total Amount"),t.k0s(),t.j41(14,"th",53),t.EFF(15,"Receipts (Paid)"),t.k0s(),t.j41(16,"th",53),t.EFF(17,"Remaining Due"),t.k0s(),t.j41(18,"th",53),t.EFF(19,"Status"),t.k0s(),t.j41(20,"th",53),t.EFF(21,"Due Date"),t.k0s(),t.j41(22,"th",54),t.EFF(23,"Actions"),t.k0s()()(),t.j41(24,"tbody"),t.DNE(25,it,33,40,"tr",126),t.k0s()()()),2&o){const n=t.XpG(2);t.R7$(25),t.Y8G("ngForOf",n.filteredInvoices)("ngForTrackBy",n.trackByLedgerRowId)}}function st(o,c){1&o&&(t.j41(0,"div",142),t.nrm(1,"i",143),t.j41(2,"p",98),t.EFF(3,"No invoices found for this student."),t.k0s(),t.j41(4,"small",98),t.EFF(5,"Try selecting a different academic year or contact admin."),t.k0s()())}function ct(o,c){if(1&o&&(t.j41(0,"div",50),t.DNE(1,V,5,3,"div",76)(2,H,28,11,"div",77)(3,Q,4,3,"div",76)(4,q,26,3,"div",78)(5,tt,3,0,"div",79)(6,at,26,2,"div",80)(7,st,6,0,"div",81),t.k0s()),2&o){const n=t.XpG();t.R7$(),t.Y8G("ngIf",n.ledgers.length>0),t.R7$(),t.Y8G("ngIf",n.summary),t.R7$(),t.Y8G("ngIf",n.overallPayments.length>0),t.R7$(),t.Y8G("ngIf",n.showPaymentHistory&&n.overallPayments.length>0),t.R7$(),t.Y8G("ngIf",n.showPaymentHistory&&0===n.overallPayments.length),t.R7$(),t.Y8G("ngIf",n.ledgerData.length>0),t.R7$(),t.Y8G("ngIf",0===n.ledgers.length)}}function rt(o,c){if(1&o){const n=t.RV6();t.j41(0,"app-pagination",144),t.bIt("pageChange",function(e){t.eBV(n);const s=t.XpG();return t.Njj(s.onPageChange(e))})("pageSizeChange",function(e){t.eBV(n);const s=t.XpG();return t.Njj(s.onPageSizeChange(e))}),t.k0s()}if(2&o){const n=t.XpG();t.Y8G("currentPage",n.currentPage)("pageSize",n.pageSize)("totalItems",n.totalItems)("pageSizeOptions",n.pageSizeOptions)}}function lt(o,c){if(1&o){const n=t.RV6();t.j41(0,"div",145),t.nrm(1,"i",146),t.EFF(2),t.j41(3,"button",147),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.clearError())}),t.k0s()()}if(2&o){const n=t.XpG();t.R7$(2),t.SpI(" ",n.errorMessage," ")}}let gt=(()=>{class o{constructor(n,i,e,s,l,M,b,f,dt){this.feeService=n,this.authService=i,this.classSubjectService=e,this.studentService=s,this.toastr=l,this.datePipe=M,this.route=b,this.router=f,this.cdr=dt,this.schoolId=null,this.activeAcademicYearId=null,this.classList=[],this.studentData=[],this.searchResults=[],this.searchQuery="",this.queryLength=0,this.showDropdown=!1,this.selectedClassId="",this.selectedClassName="",this.selectedStudentId="",this.selectedStudent=null,this.month="",this.invoices=[],this.filteredInvoices=[],this.statusFilter="",this.currentPage=1,this.pageSize=10,this.totalItems=0,this.pageSizeOptions=[10,25,50,100],this.viewMode="class",this.summary=null,this.ledgerData=[],this.selectedLedger=null,this.ledgers=[],this.showPaymentHistory=!1,this.overallPayments=[],this.errorMessage=null,this.destroy$=new P.B,this.searchSubject=new P.B}ngOnInit(){if(this.schoolId=this.authService.getSchoolId(),this.activeAcademicYearId=this.authService.getActiveAcademicYearId(),this.schoolId){if(!this.activeAcademicYearId||!this.isValidObjectId(this.activeAcademicYearId))return void this.setError("No valid active academic year found. Please set an active academic year.");this.loadClasses(),this.setupSearchDebounce()}else this.setError("School ID not found. Please log in again.");this.route.queryParams.pipe((0,_.Q)(this.destroy$)).subscribe(n=>{if(n.classId&&n.month){this.selectedClassId=n.classId,this.month=n.month;const i=this.classList.find(e=>e.id===this.selectedClassId);i&&(this.selectedClassName=i.name,this.loadStudents().then(()=>{this.loadInvoices()}))}}),this.setViewMode("class")}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setError(n){this.errorMessage=n,this.toastr.error(n),this.cdr.markForCheck()}clearError(){this.errorMessage=null,this.cdr.markForCheck()}isValidObjectId(n){return/^[0-9a-fA-F]{24}$/.test(n)}trackByClassId(n,i){return i.id}trackByStudentId(n,i){return i._id}trackByInvoiceId(n,i){return i._id}trackByLedgerId(n,i){return i.yearId}trackByLedgerRowId(n,i){return i._id}trackByPaymentId(n,i){return i._id}loadClasses(){this.classSubjectService.getClassesBySchool(this.schoolId).subscribe({next:n=>{this.classList=n.map(i=>({id:i._id,name:i.name})),0===this.classList.length&&this.toastr.warning("No classes found for this school."),this.cdr.markForCheck()},error:n=>{console.error("Error loading classes:",n),this.setError(n.error?.message||"Failed to load classes.")}})}loadStudents(){return new Promise((n,i)=>{if(!this.selectedClassId||!this.activeAcademicYearId)return this.studentData=[],void n();this.studentService.getStudentsByClass(this.selectedClassId,this.activeAcademicYearId).subscribe({next:e=>{this.studentData=e.students||[],0===this.studentData.length&&this.toastr.warning("No students found for the selected class."),n()},error:e=>{console.error("Error loading students:",e),this.setError(e.error?.message||"Failed to load students."),this.studentData=[],i(e)}})})}updateClassSelection(n){const i=n.target,e=this.classList.find(s=>s.id===i.value);e&&(this.selectedClassId=e.id,this.selectedClassName=e.name,this.selectedStudentId="",this.selectedStudent=null,this.viewMode="class",this.month&&this.loadInvoices()),this.cdr.markForCheck()}setupSearchDebounce(){this.searchSubject.pipe((0,O.B)(300),(0,a.F)(),(0,_.Q)(this.destroy$)).subscribe(n=>{n.length>=2?this.performStudentSearch(n):(this.searchResults=[],this.showDropdown=!1)})}searchStudents(n){const i=n.target.value;this.searchQuery=i,this.queryLength=i.length,i.length>=2?(this.showDropdown=!0,this.searchSubject.next(i)):(this.showDropdown=!1,this.searchResults=[]),this.cdr.markForCheck()}onDocumentClick(n){this.searchInput&&!this.searchInput.nativeElement.contains(n.target)&&(this.showDropdown=!1,this.cdr.markForCheck())}performStudentSearch(n){this.feeService.searchInvoiceStudents(n,this.schoolId).subscribe({next:i=>{this.searchResults=i.students||[],this.showDropdown=this.searchResults.length>0,this.cdr.markForCheck()},error:()=>{this.searchResults=[],this.showDropdown=!1,this.setError("Failed to search students")}})}selectStudentFromList(n){this.selectedStudentId=n._id,this.selectedStudent=n,this.searchQuery=`${n.name} ${n.admissionNo?`(${n.admissionNo})`:""}`,this.showDropdown=!1,this.getStudentInvoicesData(n._id),this.cdr.markForCheck()}getStudentInvoicesData(n){this.feeService.getStudentInvoices(n).subscribe({next:i=>{this.ledgers=i.ledgers||[],this.ledgers.length>0?(this.selectedLedger=this.ledgers[this.ledgers.length-1],this.updateLedgerTable()):(this.ledgerData=[],this.summary={}),this.loadPaymentHistory(n)},error:i=>{this.setError(i.error?.message||"Failed to load invoices"),this.ledgers=[]}})}loadPaymentHistory(n){this.feeService.getStudentPaymentHistory(n).subscribe({next:i=>{i.success&&(this.overallPayments=i.data||[],this.overallPayments.sort((e,s)=>{const l=e.invoiceMonth?new Date(`${e.invoiceMonth}-01`):new Date(0),M=s.invoiceMonth?new Date(`${s.invoiceMonth}-01`):new Date(0);return l.getTime()-M.getTime()}),console.log("Payments sorted for cumulative:",this.overallPayments)),this.cdr.markForCheck()},error:i=>{console.error("Failed to load payment history:",i),this.overallPayments=[],this.cdr.markForCheck()}})}updateLedgerTable(){this.selectedLedger&&(this.ledgerData=this.selectedLedger.ledger||[],this.summary=this.selectedLedger.summary||{},this.totalItems=this.ledgerData.length,this.filteredInvoices=[...this.ledgerData],this.filterInvoices(),this.cdr.markForCheck())}onAcademicYearChange(){this.updateLedgerTable()}togglePaymentHistory(){this.showPaymentHistory=!this.showPaymentHistory,this.cdr.markForCheck()}getBalanceAfter(n){if(0===this.overallPayments.length||!this.summary||!this.ledgerData.length)return this.summary?.totalDue||0;let i=0,e=0;for(let l=0;l<=n;l++){const M=this.overallPayments[l],b=this.ledgerData.findIndex(f=>f.month===M.invoiceMonth);if(b>=0)for(let f=0;f<=b;f++)i+=this.ledgerData[f].currentFee;e+=M.amount}return i-e}getTotalPaid(){return this.overallPayments.reduce((n,i)=>n+i.amount,0)}loadInvoices(){!this.selectedClassId||!this.month||!this.activeAcademicYearId||this.feeService.getInvoicesByClassAndMonth(this.selectedClassId,this.month,this.activeAcademicYearId).subscribe({next:n=>{this.invoices=n.data||[],this.totalItems=this.invoices.length,this.filterInvoices()},error:n=>{this.setError("Failed to load invoices")}})}filterInvoices(){let i=("class"===this.viewMode?this.invoices:this.ledgerData).map(l=>{const M=new Date(l.dueDate);return"Pending"===l.status&&new Date("2025-11-14")>M?{...l,status:"Overdue"}:l});this.statusFilter&&(i=i.filter(l=>l.status===this.statusFilter)),this.totalItems=i.length;const e=(this.currentPage-1)*this.pageSize;this.filteredInvoices=i.slice(e,e+this.pageSize),this.cdr.markForCheck()}setViewMode(n){this.viewMode=n,"class"===this.viewMode?(this.selectedStudentId="",this.selectedStudent=null,this.searchQuery="",this.searchResults=[],this.showDropdown=!1,this.ledgerData=[],this.summary=null,this.overallPayments=[],this.month&&this.selectedClassId&&this.loadInvoices()):(this.ledgerData=[],this.filteredInvoices=[],this.overallPayments=[]),this.filterInvoices(),this.cdr.markForCheck()}onPageChange(n){this.currentPage=n,this.filterInvoices()}onPageSizeChange(n){this.pageSize=n,this.currentPage=1,this.filterInvoices()}downloadInvoicePDF(n){this.feeService.downloadInvoicePDF(n).subscribe({next:i=>{const e=window.URL.createObjectURL(i),s=document.createElement("a");s.href=e,s.download=`invoice_${n}.pdf`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(e),this.toastr.success("Invoice PDF downloaded successfully.")},error:i=>{console.error("Error downloading PDF:",i),this.setError(i.error?.message||i.message||"Failed to download invoice PDF.")}})}processPayment(n,i){this.feeService.getInvoiceById(n).subscribe({next:e=>{const s=e.data;s&&s.student?._id?this.router.navigate(["/fee/payment",n]):this.setError("Invalid invoice data or student not found.")},error:e=>{this.setError("Failed to load invoice details: "+(e.error?.message||e.message)),console.error("Error fetching invoice:",e)}})}notifyParents(){this.selectedClassId&&this.month&&this.activeAcademicYearId?this.feeService.notifyParents(this.selectedClassId,this.month,this.activeAcademicYearId).subscribe({next:n=>{this.toastr.success(n.message)},error:n=>{console.error("Error notifying parents:",n),this.setError(n.error?.message||n.message||"Failed to notify parents.")}}):this.setError("Please select a class and month.")}getInitials(n){return n.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2)}get minMonth(){return this.datePipe.transform(new Date,"yyyy-MM")||""}get maxMonth(){const n=new Date;return n.setFullYear(n.getFullYear()+1),this.datePipe.transform(n,"yyyy-MM")||""}getRowClass(n){return"Overdue"===n?"table-danger":""}getStatusClass(n){switch(n){case"Paid":return"bg-success text-white";case"Pending":return"bg-warning text-dark";case"Partial":return"bg-info text-white";case"Overdue":return"bg-danger text-white";default:return"bg-secondary text-white"}}openStudentView(n,i){n?(this.selectedStudentId=n,this.selectedStudent={_id:n,name:i},this.viewMode="student",this.searchQuery=i,this.searchStudents({target:{value:i}}),this.getStudentInvoicesData(n)):this.setError("Student ID not found")}getColspan(){return"student"===this.viewMode?10:7}static{this.\u0275fac=function(i){return new(i||o)(t.rXU(g.G),t.rXU(u.u),t.rXU(v.e),t.rXU(y.b),t.rXU(k.tw),t.rXU(d.vh),t.rXU(h.nX),t.rXU(h.Ix),t.rXU(t.gRc))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-bulk-invoice-list"]],viewQuery:function(i,e){if(1&i&&t.GBs(x,5),2&i){let s;t.mGM(s=t.lsd())&&(e.searchInput=s.first)}},features:[t.Jv_([d.vh])],decls:52,vars:25,consts:[["searchInput",""],[1,"invoice-container",3,"click"],[1,"header-section"],[1,"title"],[1,"subtitle"],[1,"controls-section"],[1,"toggle-group"],["role","button","aria-label","Switch to Class View",1,"toggle-btn",3,"click","ngClass"],[1,"fas","fa-users"],["aria-label","Switch to Student View",1,"toggle-btn",3,"click","ngClass","disabled"],[1,"fas","fa-user"],[1,"filter-group"],[1,"filter-item"],["for","classSelect"],["id","classSelect","aria-label","Select Class",1,"form-select",3,"ngModelChange","change","ngModel","disabled"],["value",""],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[1,"fas","fa-graduation-cap"],["class","filter-item student-search-container",4,"ngIf"],["for","monthFilter"],["id","monthFilter","type","month","aria-label","Select Month",1,"form-input",3,"ngModelChange","change","ngModel","min","max"],[1,"fas","fa-calendar-alt"],["for","statusFilter"],["id","statusFilter","aria-label","Filter by Status",1,"form-select",3,"ngModelChange","change","ngModel"],["value","Pending"],["value","Partial"],["value","Paid"],["value","Overdue"],[1,"fas","fa-filter"],["aria-label","Notify Parents about Due Invoices",1,"btn-notify",3,"click","disabled"],[1,"fas","fa-bell"],["class","invoice-title",4,"ngIf"],["class","table-wrapper",4,"ngIf"],["aria-label","Pagination Navigation",3,"currentPage","pageSize","totalItems","pageSizeOptions","pageChange","pageSizeChange",4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],[3,"value"],[1,"filter-item","student-search-container"],["for","studentSearch"],["id","studentSearch","type","search","placeholder","Search by name or admission no...","aria-describedby","search-help","autocomplete","off",1,"form-input",3,"ngModelChange","input","ngModel"],[1,"fas","fa-search"],["class","dropdown",4,"ngIf"],["class","form-text text-muted",4,"ngIf"],[1,"dropdown"],[3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],[1,"student-name"],["class","admission-no",4,"ngIf"],[1,"admission-no"],[1,"form-text","text-muted"],[1,"invoice-title"],[1,"table-wrapper"],[1,"table-responsive"],["role","table","aria-label","Class Invoices Table",1,"professional-table","invoice-table"],["scope","col"],["scope","col",1,"text-center"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","row","aria-label","No results",4,"ngIf"],["data-label","Student",1,"profile-cell"],[1,"profile-wrapper"],[1,"avatar-placeholder"],[1,"teacher-name"],["data-label","Total Amount"],["data-label","Remaining Due",3,"ngClass"],["data-label","Status"],["role","status",1,"badge",3,"ngClass"],["data-label","Due Date"],["data-label","Actions",1,"text-center"],["type","button",1,"btn-material","btn-sm","btn-outline-primary",3,"click"],[1,"fas","fa-download"],["class","btn-material btn-sm btn-outline-success","type","button",3,"click",4,"ngIf"],["type","button",1,"btn-material","btn-sm","btn-outline-info",3,"click"],[1,"fas","fa-eye"],["type","button",1,"btn-material","btn-sm","btn-outline-success",3,"click"],[1,"fas","fa-money-bill-wave"],["role","row","aria-label","No results"],["colspan","7","role","cell",1,"text-center","no-data"],["class","mb-3",4,"ngIf"],["class","summary-card mb-3 p-4 bg-white rounded-lg shadow-md","role","region","aria-label","Payment Summary",4,"ngIf"],["id","payment-history-table","class","payment-history-section mb-4","role","region","aria-label","Payment History",4,"ngIf"],["class","alert alert-info","role","alert",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","text-center py-5","role","alert","aria-label","No Invoices",4,"ngIf"],[1,"mb-3"],["for","academicYearSelect",1,"form-label","fw-bold"],["id","academicYearSelect","aria-label","Select Academic Year",1,"form-select",3,"ngModelChange","change","ngModel"],[3,"ngValue",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngValue"],["role","region","aria-label","Payment Summary",1,"summary-card","mb-3","p-4","bg-white","rounded-lg","shadow-md"],[1,"row","g-3","text-center"],[1,"col-md-3","col-6"],[1,"fas","fa-check-circle","text-success","fa-2x","mb-2"],[1,"text-success"],[1,"h5"],[1,"fas","fa-exclamation-circle","text-danger","fa-2x","mb-2"],[1,"text-danger"],[1,"fas","fa-calendar-check","text-info","fa-2x","mb-2"],[1,"text-info"],[1,"fas","fa-clock","text-warning","fa-2x","mb-2"],[1,"text-muted"],[1,"h5","text-warning"],["aria-controls","payment-history-table","type","button",1,"btn","btn-outline-info",3,"click"],[1,"fas","fa-history","me-2"],["id","payment-history-table","role","region","aria-label","Payment History",1,"payment-history-section","mb-4"],[1,"fas","fa-money-bill-wave","me-2"],["role","table","aria-label","Payment History Table",1,"table","table-striped","table-hover","table-sm","history-table"],[1,"table-dark"],[1,"fw-bold","text-muted"],["data-label","Date & Time"],[1,"d-block","text-muted"],["data-label","Amount",1,"text-success","fw-bold"],["data-label","Method"],[1,"badge",3,"ngClass"],["data-label","Reference"],["class","text-info small",4,"ngIf"],["class","text-warning small",4,"ngIf"],["class","text-muted small",4,"ngIf"],["data-label","Invoice Month"],[1,"badge","bg-light","text-dark"],["data-label","Processed By",1,"text-muted"],["data-label","Balance After",1,"text-end","fw-bold",3,"ngClass"],[1,"text-info","small"],[1,"text-warning","small"],[1,"text-muted","small"],["role","alert",1,"alert","alert-info"],[1,"fas","fa-info-circle","me-2"],["role","table","aria-label","Student Ledger Table",1,"table","table-striped","table-hover","ledger-table"],["role","row",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["role","row",3,"ngClass"],["data-label","Month",1,"fw-bold","text-primary"],["data-label","Previous Dues",1,"text-end",3,"ngClass"],["class","d-block text-muted",4,"ngIf"],["data-label","Current Fee",1,"text-end"],["data-label","Total Amount",1,"text-end","fw-bold","text-primary"],["data-label","Receipts (Paid)",1,"text-end","text-success"],["data-label","Remaining Due",1,"text-end","fw-bold",3,"ngClass"],["role","status",1,"badge","rounded-pill","px-2","py-1",3,"ngClass"],["data-label","Due Date",1,"text-muted"],["type","button",1,"btn","btn-sm","btn-outline-primary","me-1",3,"click"],[1,"fas","fa-download","me-1"],["class","btn btn-sm btn-outline-success me-1","type","button",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-outline-success","me-1",3,"click"],[1,"fas","fa-money-bill-wave","me-1"],["role","alert","aria-label","No Invoices",1,"text-center","py-5"],[1,"fas","fa-inbox","fa-3x","text-muted","mb-3"],["aria-label","Pagination Navigation",3,"pageChange","pageSizeChange","currentPage","pageSize","totalItems","pageSizeOptions"],["role","alert",1,"alert","alert-danger"],[1,"fas","fa-exclamation-triangle","me-2"],["type","button",1,"btn-close","float-end",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",1),t.bIt("click",function(l){return e.onDocumentClick(l)}),t.j41(1,"div",2)(2,"h1",3),t.EFF(3,"Invoice Management Dashboard"),t.k0s(),t.j41(4,"p",4),t.EFF(5,"Manage and track invoices for students and classes efficiently."),t.k0s()(),t.j41(6,"div",5)(7,"div",6)(8,"button",7),t.bIt("click",function(){return e.setViewMode("class")}),t.nrm(9,"i",8),t.EFF(10," Class View "),t.k0s(),t.j41(11,"button",9),t.bIt("click",function(){return e.setViewMode("student")}),t.nrm(12,"i",10),t.EFF(13," Student View "),t.k0s()(),t.j41(14,"div",11)(15,"div",12)(16,"label",13),t.EFF(17,"Class"),t.k0s(),t.j41(18,"select",14),t.mxI("ngModelChange",function(l){return t.DH7(e.selectedClassId,l)||(e.selectedClassId=l),l}),t.bIt("change",function(l){return e.updateClassSelection(l)}),t.j41(19,"option",15),t.EFF(20,"Select Class"),t.k0s(),t.DNE(21,$,2,2,"option",16),t.k0s(),t.nrm(22,"i",17),t.k0s(),t.DNE(23,U,8,3,"div",18),t.j41(24,"div",12)(25,"label",19),t.EFF(26,"Month"),t.k0s(),t.j41(27,"input",20),t.mxI("ngModelChange",function(l){return t.DH7(e.month,l)||(e.month=l),l}),t.bIt("change",function(){return e.loadInvoices()}),t.k0s(),t.nrm(28,"i",21),t.k0s(),t.j41(29,"div",12)(30,"label",22),t.EFF(31,"Status"),t.k0s(),t.j41(32,"select",23),t.mxI("ngModelChange",function(l){return t.DH7(e.statusFilter,l)||(e.statusFilter=l),l}),t.bIt("change",function(){return e.filterInvoices()}),t.j41(33,"option",15),t.EFF(34,"All Statuses"),t.k0s(),t.j41(35,"option",24),t.EFF(36,"Pending"),t.k0s(),t.j41(37,"option",25),t.EFF(38,"Partial"),t.k0s(),t.j41(39,"option",26),t.EFF(40,"Paid"),t.k0s(),t.j41(41,"option",27),t.EFF(42,"Overdue"),t.k0s()(),t.nrm(43,"i",28),t.k0s(),t.j41(44,"button",29),t.bIt("click",function(){return e.notifyParents()}),t.nrm(45,"i",30),t.EFF(46," Notify Parents "),t.k0s()()(),t.DNE(47,G,3,2,"div",31)(48,z,22,3,"div",32)(49,ct,8,7,"div",32)(50,rt,1,4,"app-pagination",33)(51,lt,4,1,"div",34),t.k0s()),2&i&&(t.R7$(8),t.Y8G("ngClass",t.eq3(21,w,"class"===e.viewMode)),t.BMQ("aria-pressed","class"===e.viewMode),t.R7$(3),t.Y8G("ngClass",t.eq3(23,w,"student"===e.viewMode))("disabled",!e.selectedClassId),t.BMQ("aria-disabled",!e.selectedClassId),t.R7$(7),t.R50("ngModel",e.selectedClassId),t.Y8G("disabled",0===e.classList.length),t.R7$(3),t.Y8G("ngForOf",e.classList)("ngForTrackBy",e.trackByClassId),t.R7$(2),t.Y8G("ngIf","student"===e.viewMode),t.R7$(4),t.R50("ngModel",e.month),t.Y8G("min",e.minMonth)("max",e.maxMonth),t.R7$(5),t.R50("ngModel",e.statusFilter),t.R7$(12),t.Y8G("disabled",!e.selectedClassId||!e.month),t.BMQ("aria-disabled",!e.selectedClassId||!e.month),t.R7$(3),t.Y8G("ngIf",e.selectedClassName&&e.month),t.R7$(),t.Y8G("ngIf","class"===e.viewMode),t.R7$(),t.Y8G("ngIf","student"===e.viewMode),t.R7$(),t.Y8G("ngIf",e.filteredInvoices.length>0),t.R7$(),t.Y8G("ngIf",e.errorMessage))},dependencies:[d.MD,d.YU,d.Sq,d.bT,d.oe,d.vh,p.YN,p.xH,p.y7,p.me,p.wz,p.BC,p.vS,m.e],styles:['@import"https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap";@import"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css";.ledger-table[_ngcontent-%COMP%]{font-size:.85rem}.ledger-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#2c3e50;color:#fff}.ledger-table[_ngcontent-%COMP%]   .table-overdue[_ngcontent-%COMP%]{background-color:#2c3e50}.ledger-table[_ngcontent-%COMP%]   .profile-wrapper[_ngcontent-%COMP%]{min-width:150px}.ledger-table[_ngcontent-%COMP%]   .avatar-placeholder[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.75rem}.ledger-table[_ngcontent-%COMP%]   .payment-history[_ngcontent-%COMP%]{border-left:4px solid #007bff}.ledger-table[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%], .ledger-table[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.8rem}.ledger-table[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a}.ledger-table[_ngcontent-%COMP%]   .no-data[_ngcontent-%COMP%]{color:#6c757d;font-style:italic}.invoice-container[_ngcontent-%COMP%]{padding:20px;font-family:Poppins,sans-serif;background:linear-gradient(135deg,#f5f7fa,#c3cfe2);min-height:100vh;max-width:1400px;margin:0 auto}.invoice-container[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px;padding:20px;background:#ffffffe6;border-radius:16px;box-shadow:0 1px 3px #0000001a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.invoice-container[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;background:linear-gradient(135deg,#2c3e50,#3b82f6);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin:0;letter-spacing:-.5px}.invoice-container[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1rem;color:#6b7280;margin:8px 0 0;font-weight:400}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;margin-bottom:30px}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .toggle-group[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .toggle-group[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]{padding:10px 20px;border:2px solid #2C3E50;background:#fffc;color:#2c3e50;border-radius:50px;cursor:pointer;font-weight:600;font-size:.95rem;transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:0 1px 3px #0000001a}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .toggle-group[_ngcontent-%COMP%]   .toggle-btn.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2c3e50,#3b82f6);color:#fff;transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .toggle-group[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 12px #00000026}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .toggle-group[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;align-items:end;padding:20px;background:#ffffffe6;border-radius:16px;box-shadow:0 1px 3px #0000001a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid #e5e7eb}@media (max-width: 767px){.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px;padding:15px}}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600;color:#2c3e50;margin-bottom:4px;display:block}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   input[type=month][_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   input[type=search][_ngcontent-%COMP%]{padding:12px 16px 12px 45px;border:2px solid #e5e7eb;border-radius:12px;font-size:.95rem;background:#fff;transition:all .3s cubic-bezier(.4,0,.2,1);min-height:48px;box-shadow:inset 0 1px 3px #0000000d}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:focus, .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus, .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   input[type=month][_ngcontent-%COMP%]:focus, .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   input[type=search][_ngcontent-%COMP%]:focus{border-color:#3b82f6;outline:none;box-shadow:0 0 0 3px #3b82f61a,inset 0 1px 3px #0000000d;transform:translateY(-1px)}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:disabled, .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:disabled, .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   input[type=month][_ngcontent-%COMP%]:disabled, .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   input[type=search][_ngcontent-%COMP%]:disabled{background-color:#f3f4f6;cursor:not-allowed}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;left:14px;top:45px!important;transform:translateY(-40%);color:#9ca3af;font-size:1rem;z-index:1;transition:color .3s ease}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + i[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus + i[_ngcontent-%COMP%]{color:#3b82f6}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .student-search-container[_ngcontent-%COMP%]{position:relative}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .student-search-container[_ngcontent-%COMP%]   input[type=search][_ngcontent-%COMP%]{background-image:none;padding-left:45px;padding-right:16px}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .student-search-container[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:#fff;border:1px solid #e5e7eb;border-top:none;border-radius:0 0 12px 12px;box-shadow:0 4px 12px #00000026;max-height:200px;overflow-y:auto;z-index:1000;animation:_ngcontent-%COMP%_slideDown .3s cubic-bezier(.4,0,.2,1)}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .student-search-container[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .student-search-container[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:12px 16px;cursor:pointer;border-bottom:1px solid #e5e7eb;transition:background-color .2s ease;font-size:.95rem;display:flex;align-items:center;gap:8px}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .student-search-container[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#3b82f61a}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .student-search-container[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom:none}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .student-search-container[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .student-name[_ngcontent-%COMP%]{font-weight:500;color:#2c3e50}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .student-search-container[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .admission-no[_ngcontent-%COMP%]{color:#6b7280;font-size:.85rem}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .btn-notify[_ngcontent-%COMP%]{padding:12px 20px;background:linear-gradient(135deg,#10b981,#059669);color:#fff;border:none;border-radius:12px;font-weight:600;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);min-height:48px;display:flex;align-items:center;justify-content:center;gap:6px;box-shadow:0 1px 3px #0000001a}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .btn-notify[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .btn-notify[_ngcontent-%COMP%]:disabled{background:#9ca3af;cursor:not-allowed;transform:none}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .form-text[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;margin-top:4px;grid-column:1/-1}.invoice-container[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]{margin-bottom:25px;padding-bottom:8px;border-bottom:2px solid transparent;background:linear-gradient(135deg,#2c3e50,#3b82f6);background-clip:text;-webkit-background-clip:text}.invoice-container[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:600;color:transparent;margin:0;letter-spacing:-.3px}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]{font-family:Poppins,sans-serif}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;box-shadow:0 1px 3px #0000001a;border-radius:16px;background:#fff;overflow:hidden;font-size:.85rem}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2c3e50,#34495e)}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:12px 8px;text-align:left;font-weight:600;font-size:.85rem;color:#fff;white-space:nowrap;text-transform:uppercase;letter-spacing:.5px}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.text-center[_ngcontent-%COMP%]{text-align:center}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:all .2s ease}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f8fafc80}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#3b82f60d;transform:scale(1.01)}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 8px;color:#2c3e50;font-size:.8rem;vertical-align:middle;border-bottom:1px solid #e5e7eb}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-center[_ngcontent-%COMP%]{text-align:center}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-bottom:none}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   .profile-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   .profile-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   .avatar-placeholder[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,#2c3e50,#3b82f6);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:600;font-size:.8rem;text-transform:uppercase;flex-shrink:0;box-shadow:0 1px 3px #0000001a}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   .teacher-name[_ngcontent-%COMP%]{font-weight:500;color:#2c3e50;font-size:.85rem}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.7rem;padding:4px 10px;border-radius:20px;font-weight:600;box-shadow:0 1px 3px #0000001a}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   .badge.bg-success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);color:#fff}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   .badge.bg-warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b,#d97706);color:#fff}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   .badge.bg-info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   .badge.bg-danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   .no-data[_ngcontent-%COMP%]{text-align:center;font-weight:500;color:#6b7280;padding:40px;font-style:italic}.invoice-container[_ngcontent-%COMP%]   .payment-history-section[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:12px;padding:20px;background:#ffffffe6;margin-bottom:20px;box-shadow:0 1px 3px #0000001a}.invoice-container[_ngcontent-%COMP%]   .payment-history-section[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin-bottom:15px;color:#2c3e50;font-weight:600;display:flex;align-items:center;gap:8px}.invoice-container[_ngcontent-%COMP%]   .payment-history-section[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]{margin-bottom:0}.invoice-container[_ngcontent-%COMP%]   .payment-history-section[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#2c3e50;font-weight:600;color:#fff;border:none;padding:10px 6px;font-size:.8rem}.invoice-container[_ngcontent-%COMP%]   .payment-history-section[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-color:#e5e7eb;vertical-align:middle;padding:10px 6px;font-size:.75rem}.invoice-container[_ngcontent-%COMP%]   .payment-history-section[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.65rem;padding:3px 6px;border-radius:12px}.invoice-container[_ngcontent-%COMP%]   .btn-material[_ngcontent-%COMP%]{border:none;border-radius:20px;margin-right:6px;padding:6px 10px;font-weight:600;font-size:.75rem;text-transform:uppercase;letter-spacing:.3px;box-shadow:0 1px 3px #0000001a;transition:all .3s cubic-bezier(.4,0,.2,1);display:inline-flex;align-items:center;gap:4px;min-width:75px;justify-content:center;white-space:nowrap}.invoice-container[_ngcontent-%COMP%]   .btn-material[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.8rem}.invoice-container[_ngcontent-%COMP%]   .btn-material[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.invoice-container[_ngcontent-%COMP%]   .btn-material.btn-outline-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff}.invoice-container[_ngcontent-%COMP%]   .btn-material.btn-outline-success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);color:#fff}.invoice-container[_ngcontent-%COMP%]   .btn-material.btn-outline-info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563);color:#fff}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 767px){.invoice-container[_ngcontent-%COMP%]{padding:10px}.invoice-container[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]{padding:15px;margin-bottom:20px}.invoice-container[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.5rem}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]{gap:15px}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:10px;padding:15px}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   input[type=month][_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]   input[type=search][_ngcontent-%COMP%]{padding:12px 16px 12px 45px;min-height:44px}.invoice-container[_ngcontent-%COMP%]   .controls-section[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .btn-notify[_ngcontent-%COMP%]{min-height:44px}.invoice-container[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:12px;border:1px solid #e5e7eb;border-radius:12px;padding:15px;background:#fff;box-shadow:0 1px 3px #0000001a;transition:box-shadow .2s ease}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover, .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover, .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026;transform:none}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:block;padding:8px 0;font-size:.8rem;border:none!important;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before, .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before, .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label) ": ";font-weight:600;color:#2c3e50;flex-shrink:0;min-width:100px}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child, .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child, .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-bottom:none}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.profile-cell[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.profile-cell[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.profile-cell[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:8px;text-align:left}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.profile-cell[_ngcontent-%COMP%]   .profile-wrapper[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.profile-cell[_ngcontent-%COMP%]   .profile-wrapper[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.profile-cell[_ngcontent-%COMP%]   .profile-wrapper[_ngcontent-%COMP%]{width:100%}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-center[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-center[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-center[_ngcontent-%COMP%]{text-align:left;flex-direction:row;justify-content:space-between}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-center[_ngcontent-%COMP%]   .btn-material[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-center[_ngcontent-%COMP%]   .btn-material[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-center[_ngcontent-%COMP%]   .btn-material[_ngcontent-%COMP%]{flex:1;margin:0 2px;padding:8px 6px;font-size:.7rem;min-width:auto}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-end[_ngcontent-%COMP%]:before, .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-end[_ngcontent-%COMP%]:before, .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-end[_ngcontent-%COMP%]:before{order:2}.invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-end[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .professional-table.invoice-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-end[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-end[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .ledger-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-end[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-end[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .invoice-container[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .history-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.text-end[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{order:1;text-align:right}.invoice-container[_ngcontent-%COMP%]   .payment-history-section[_ngcontent-%COMP%]{padding:15px}.invoice-container[_ngcontent-%COMP%]   .btn-material[_ngcontent-%COMP%]{flex:1;margin:2px;padding:8px 6px;font-size:.7rem}}.invoice-container[_ngcontent-%COMP%]   .sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}'],changeDetection:0})}}return o})()},2329:(I,C,r)=>{r.d(C,{G:()=>P});var d=r(2525),p=r(4438),m=r(1626);let P=(()=>{class _{constructor(a){this.http=a,this.apiUrl=d.c.apiUrl}getFeeStructures(a){return this.http.get(`${this.apiUrl}/api/fees/structures`,{params:{schoolId:a}})}getStudentInvoices(a,t){const g={};return t&&(g.academicYearId=t),this.http.get(`${this.apiUrl}/api/fees/invoices/student/${a}`,{params:g})}searchInvoiceStudents(a,t){return this.http.get(`${this.apiUrl}/api/fees/search`,{params:{q:a,schoolId:t}})}createFeeStructure(a){return this.http.post(`${this.apiUrl}/api/fees/structures`,a)}updateFeeStructure(a,t){return this.http.put(`${this.apiUrl}/api/fees/structures/${a}`,t)}deleteFeeStructure(a){return this.http.delete(`${this.apiUrl}/api/fees/structures/${a}`)}generateInvoices(a){return this.http.post(`${this.apiUrl}/api/fees/generate`,a)}getStudentFeeSummary(a){return this.http.get(`${this.apiUrl}/api/fees/students/${a}/summary`)}getInvoiceById(a){return this.http.get(`${this.apiUrl}/api/fees/invoices/${a}`)}generateAdvanceInvoices(a){return this.http.post(`${this.apiUrl}/api/fees/invoices/advance`,a)}processPayment(a,t){return this.http.post(`${this.apiUrl}/api/fees/students/${a}/payments`,t)}getFeeCollectionReport(a){return this.http.get(`${this.apiUrl}/api/fees/reports/collection-details`,{params:a})}generateClassReceipts(a){return this.http.post(`${this.apiUrl}/api/fees/receipts`,a,{responseType:"blob"})}getPaidInvoiceList(a){return this.http.get(`${this.apiUrl}/api/fees/paid-invoices`,{params:a})}getInvoicesByClassAndMonth(a,t,g){return this.http.get(`${this.apiUrl}/api/fees/invoices`,{params:{classId:a,month:t,academicYearId:g}})}getStudentPaymentHistory(a){return this.http.get(`${this.apiUrl}/api/fees/students/${a}/payment-history`)}downloadInvoicePDF(a){return this.http.get(`${this.apiUrl}/api/fees/invoices/${a}/pdf`,{responseType:"blob"})}downloadReceiptPDF(a){return this.http.get(`${this.apiUrl}/api/fees/receipts/${a}/pdf`,{responseType:"blob"})}notifyParents(a,t,g){return this.http.post(`${this.apiUrl}/api/fees/notify-parents`,{classId:a,month:t,academicYearId:g})}static{this.\u0275fac=function(t){return new(t||_)(p.KVO(m.Qq))}}static{this.\u0275prov=p.jDH({token:_,factory:_.\u0275fac,providedIn:"root"})}}return _})()},152:(I,C,r)=>{r.d(C,{B:()=>P});var d=r(3236),p=r(9974),m=r(4360);function P(_,O=d.E){return(0,p.N)((a,t)=>{let g=null,u=null,v=null;const y=()=>{if(g){g.unsubscribe(),g=null;const h=u;u=null,t.next(h)}};function k(){const h=v+_,x=O.now();if(x<h)return g=this.schedule(void 0,h-x),void t.add(g);y()}a.subscribe((0,m._)(t,h=>{u=h,v=O.now(),g||(g=O.schedule(k,_),t.add(g))},()=>{y(),t.complete()},void 0,()=>{u=g=null}))})}}}]);