"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[6532],{6532:(S,m,a)=>{a.r(m),a.d(m,{TeacherCreateComponent:()=>B});var n=a(9417),u=a(1413),p=a(6977),d=a(177),g=a(3413),c=a(2716),f=a(1626),e=a(4438),h=a(7917),F=a(5794);function v(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1,"Name is required"),e.k0s())}function E(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1,"Minimum 3 characters"),e.k0s())}function _(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1,"Email is required"),e.k0s())}function C(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1,"Valid email required"),e.k0s())}function b(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1,"Phone is required"),e.k0s())}function j(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1,"10 digits only"),e.k0s())}function k(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1," Username is required "),e.k0s())}function T(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1," Minimum 3 characters "),e.k0s())}function P(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1,"Gender required"),e.k0s())}function y(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1,"Designation required"),e.k0s())}function O(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1,"10 digits only"),e.k0s())}function D(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1," At least one subject is required "),e.k0s())}function M(t,s){if(1&t&&(e.j41(0,"div",49),e.EFF(1),e.k0s()),2&t){const o=e.XpG();e.R7$(),e.JRh(o.fileError)}}function R(t,s){1&t&&(e.j41(0,"div",49),e.EFF(1,"Profile picture is required"),e.k0s())}function I(t,s){if(1&t&&(e.j41(0,"div",50),e.nrm(1,"img",51),e.k0s()),2&t){const o=e.XpG();e.R7$(),e.Y8G("src",o.imagePreview,e.B4B)}}function G(t,s){if(1&t&&(e.j41(0,"div",52)(1,"div",53),e.nrm(2,"div",54),e.k0s(),e.j41(3,"small",55),e.EFF(4),e.k0s()()),2&t){const o=e.XpG();e.R7$(2),e.xc7("width",o.uploadProgress,"%"),e.R7$(2),e.SpI("",o.uploadProgress,"% uploaded")}}function N(t,s){if(1&t&&(e.j41(0,"div",26)(1,"div",56),e.EFF(2),e.k0s()()),2&t){const o=e.XpG();e.R7$(2),e.JRh(o.serverError)}}function $(t,s){1&t&&e.nrm(0,"span",57)}let B=(()=>{class t{constructor(o,i,r){this.fb=o,this.teacherSvc=i,this.toastr=r,this.submitted=!1,this.loading=!1,this.uploadProgress=0,this.subjectsList=["English","Hindi","Mathematics","Environmental Science","General Knowledge","Arts","Science","Social Science","Music"],this.selectedFile=null,this.imagePreview=null,this.fileError="",this.serverError="",this.destroy$=new u.B}ngOnInit(){this.initForm()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initForm(){this.form=this.fb.group({name:["",[n.k0.required,n.k0.minLength(3),n.k0.maxLength(100)]],username:["",[n.k0.required,n.k0.minLength(3),n.k0.maxLength(50)]],email:["",[n.k0.required,n.k0.email]],phone:["",[n.k0.required,n.k0.pattern(/^\d{10}$/)]],gender:["",n.k0.required],designation:["",[n.k0.required,n.k0.maxLength(100)]],leaveBalance:[10,[n.k0.min(0)]],subjects:[[],[n.k0.required]],qualification:[""],joiningDate:[""],dateOfBirth:[""],address:[""],bloodGroup:[""],emergencyContactName:[""],emergencyContactPhone:["",n.k0.pattern(/^\d{10}$/)]})}get f(){return this.form.controls}onFileSelect(o){const i=o.target.files[0];if(!i)return;if(!["image/png","image/jpeg","image/jpg"].includes(i.type))return void(this.fileError="Only PNG/JPG/JPEG allowed");if(i.size>2097152)return void(this.fileError="Max 2 MB");this.selectedFile=i,this.fileError="";const r=new FileReader;r.onload=()=>this.imagePreview=r.result,r.readAsDataURL(i)}onSubmit(){if(this.submitted=!0,this.serverError="",this.fileError=this.selectedFile?"":"Profile picture required",this.form.invalid||!this.selectedFile)return;this.loading=!0;const o=this.buildFormData();this.teacherSvc.createTeacher(o).pipe((0,p.Q)(this.destroy$)).subscribe({next:i=>{i.type===f.hv.UploadProgress?this.uploadProgress=i.total?Math.round(100*i.loaded/i.total):0:i.type===f.hv.Response&&(this.toastr.success("Teacher added successfully!"),this.resetForm(),this.loading=!1,this.uploadProgress=0)},error:i=>{this.loading=!1,this.uploadProgress=0}})}buildFormData(){const o=new FormData,i=this.form.value;return Object.keys(i).forEach(r=>{const l=i[r];if(null!=l&&""!==l){if("phone"===r&&!/^\d{10}$/.test(l))return;if("subjects"===r)return void(Array.isArray(l)&&l.length>0&&o.append(r,JSON.stringify(l)));o.append(r,l)}}),o.append("profileImage",this.selectedFile),o}parseError(o){return o.error?.message||"Server error"}resetForm(){this.form.reset({leaveBalance:10}),this.selectedFile=null,this.imagePreview=null,this.submitted=!1,this.loading=!1,this.fileError="",this.serverError=""}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(n.ok),e.rXU(h.O),e.rXU(F.tw))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-teacher-create"]],decls:154,vars:25,consts:[[1,"container-fluid","py-3","py-md-4"],[1,"row","justify-content-center"],[1,"col-12","col-lg-10","col-xl-9"],["cardTitle","Add New Teacher"],["novalidate","",3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"form-section"],[1,"col-12","col-md-6"],[1,"form-label"],[1,"text-danger"],["type","text","formControlName","name",1,"form-control","form-control-sm"],["class","text-danger small mt-1",4,"ngIf"],["type","email","formControlName","email",1,"form-control","form-control-sm"],["type","text","formControlName","phone","placeholder","10 digits",1,"form-control","form-control-sm"],["type","text","formControlName","username",1,"form-control","form-control-sm"],[1,"alert","alert-info","small","p-2","mt-3"],["formControlName","gender",1,"form-select","form-select-sm"],["value",""],["value","Male"],["value","Female"],["value","Other"],["type","text","formControlName","designation","placeholder","e.g., Science Teacher",1,"form-control","form-control-sm"],["type","text","formControlName","qualification","placeholder","e.g., B.Ed, M.Sc",1,"form-control","form-control-sm"],["type","date","formControlName","joiningDate",1,"form-control","form-control-sm"],["type","date","formControlName","dateOfBirth",1,"form-control","form-control-sm"],["type","number","min","0","formControlName","leaveBalance","placeholder","10",1,"form-control","form-control-sm"],[1,"col-12"],["formControlName","address","rows","2",1,"form-control","form-control-sm"],["formControlName","bloodGroup",1,"form-select","form-select-sm"],["value","A+"],["value","A-"],["value","B+"],["value","B-"],["value","O+"],["value","O-"],["value","AB+"],["value","AB-"],["type","text","formControlName","emergencyContactName",1,"form-control","form-control-sm"],["type","text","formControlName","emergencyContactPhone",1,"form-control","form-control-sm"],["formControlName","subjects","placeholder","Select one or more subjects",3,"items","multiple","closeOnSelect","searchable"],[1,"row","g-3","align-items-center"],["type","file","accept","image/png,image/jpeg,image/jpg",1,"form-control","form-control-sm",3,"change"],["class","col-12 col-md-6 text-center",4,"ngIf"],["class","col-12 mt-2",4,"ngIf"],[1,"alert","alert-info","small","p-3"],["class","col-12",4,"ngIf"],[1,"col-12","d-flex","justify-content-end","gap-2"],["type","submit",1,"btn","btn-primary","btn-sm",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"text-danger","small","mt-1"],[1,"col-12","col-md-6","text-center"],["alt","Preview",1,"img-thumbnail",2,"max-height","120px",3,"src"],[1,"col-12","mt-2"],[1,"progress",2,"height","6px"],[1,"progress-bar"],[1,"text-muted","d-block","text-center","mt-1"],[1,"alert","alert-danger","small","p-2"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(i,r){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-card",3)(4,"form",4),e.bIt("ngSubmit",function(){return r.onSubmit()}),e.j41(5,"div",5)(6,"fieldset",6)(7,"legend"),e.EFF(8,"Personal Details"),e.k0s(),e.j41(9,"div",5)(10,"div",7)(11,"label",8),e.EFF(12,"Name "),e.j41(13,"span",9),e.EFF(14,"*"),e.k0s()(),e.nrm(15,"input",10),e.DNE(16,v,2,0,"div",11)(17,E,2,0,"div",11),e.k0s(),e.j41(18,"div",7)(19,"label",8),e.EFF(20,"Email "),e.j41(21,"span",9),e.EFF(22,"*"),e.k0s()(),e.nrm(23,"input",12),e.DNE(24,_,2,0,"div",11)(25,C,2,0,"div",11),e.k0s(),e.j41(26,"div",7)(27,"label",8),e.EFF(28,"Phone "),e.j41(29,"span",9),e.EFF(30,"*"),e.k0s()(),e.nrm(31,"input",13),e.DNE(32,b,2,0,"div",11)(33,j,2,0,"div",11),e.k0s(),e.j41(34,"div",7)(35,"label",8),e.EFF(36,"Username "),e.j41(37,"span",9),e.EFF(38,"*"),e.k0s()(),e.nrm(39,"input",14),e.DNE(40,k,2,0,"div",11)(41,T,2,0,"div",11),e.k0s(),e.j41(42,"div",15)(43,"strong"),e.EFF(44,"Note:"),e.k0s(),e.EFF(45," A strong temporary password will be auto-generated and sent to the teacher's email & phone. "),e.k0s(),e.j41(46,"div",7)(47,"label",8),e.EFF(48,"Gender "),e.j41(49,"span",9),e.EFF(50,"*"),e.k0s()(),e.j41(51,"select",16)(52,"option",17),e.EFF(53,"Select"),e.k0s(),e.j41(54,"option",18),e.EFF(55,"Male"),e.k0s(),e.j41(56,"option",19),e.EFF(57,"Female"),e.k0s(),e.j41(58,"option",20),e.EFF(59,"Other"),e.k0s()(),e.DNE(60,P,2,0,"div",11),e.k0s(),e.j41(61,"div",7)(62,"label",8),e.EFF(63,"Designation "),e.j41(64,"span",9),e.EFF(65,"*"),e.k0s()(),e.nrm(66,"input",21),e.DNE(67,y,2,0,"div",11),e.k0s(),e.j41(68,"div",7)(69,"label",8),e.EFF(70,"Qualification"),e.k0s(),e.nrm(71,"input",22),e.k0s(),e.j41(72,"div",7)(73,"label",8),e.EFF(74,"Joining Date"),e.k0s(),e.nrm(75,"input",23),e.k0s(),e.j41(76,"div",7)(77,"label",8),e.EFF(78,"Date of Birth"),e.k0s(),e.nrm(79,"input",24),e.k0s(),e.j41(80,"div",7)(81,"label",8),e.EFF(82,"Initial Leave Balance"),e.k0s(),e.nrm(83,"input",25),e.k0s()()(),e.j41(84,"fieldset",6)(85,"legend"),e.EFF(86,"Additional Details (Optional)"),e.k0s(),e.j41(87,"div",5)(88,"div",26)(89,"label",8),e.EFF(90,"Address"),e.k0s(),e.nrm(91,"textarea",27),e.k0s(),e.j41(92,"div",7)(93,"label",8),e.EFF(94,"Blood Group"),e.k0s(),e.j41(95,"select",28)(96,"option",17),e.EFF(97,"Select"),e.k0s(),e.j41(98,"option",29),e.EFF(99,"A+"),e.k0s(),e.j41(100,"option",30),e.EFF(101,"A-"),e.k0s(),e.j41(102,"option",31),e.EFF(103,"B+"),e.k0s(),e.j41(104,"option",32),e.EFF(105,"B-"),e.k0s(),e.j41(106,"option",33),e.EFF(107,"O+"),e.k0s(),e.j41(108,"option",34),e.EFF(109,"O-"),e.k0s(),e.j41(110,"option",35),e.EFF(111,"AB+"),e.k0s(),e.j41(112,"option",36),e.EFF(113,"AB-"),e.k0s()()(),e.j41(114,"div",7)(115,"label",8),e.EFF(116,"Emergency Contact Name"),e.k0s(),e.nrm(117,"input",37),e.k0s(),e.j41(118,"div",7)(119,"label",8),e.EFF(120,"Emergency Contact Phone"),e.k0s(),e.nrm(121,"input",38),e.DNE(122,O,2,0,"div",11),e.k0s()()(),e.j41(123,"fieldset",6)(124,"legend"),e.EFF(125,"Subjects Taught "),e.j41(126,"span",9),e.EFF(127,"*"),e.k0s()(),e.j41(128,"div",5)(129,"div",26),e.nrm(130,"ng-select",39),e.DNE(131,D,2,0,"div",11),e.k0s()()(),e.j41(132,"fieldset",6)(133,"legend"),e.EFF(134,"Profile Picture "),e.j41(135,"span",9),e.EFF(136,"*"),e.k0s()(),e.j41(137,"div",40)(138,"div",7)(139,"input",41),e.bIt("change",function(A){return r.onFileSelect(A)}),e.k0s(),e.DNE(140,M,2,1,"div",11)(141,R,2,0,"div",11),e.k0s(),e.DNE(142,I,2,1,"div",42),e.k0s(),e.DNE(143,G,5,3,"div",43),e.k0s(),e.j41(144,"div",26)(145,"div",44)(146,"strong"),e.EFF(147,"Portal Account:"),e.k0s(),e.EFF(148," A login account will be automatically created for the teacher. Username and temporary password will be sent via email and SMS. "),e.k0s()(),e.DNE(149,N,3,1,"div",45),e.j41(150,"div",46)(151,"button",47),e.DNE(152,$,1,0,"span",48),e.EFF(153),e.k0s()()()()()()()()),2&i&&(e.R7$(4),e.Y8G("formGroup",r.form),e.R7$(12),e.Y8G("ngIf",r.submitted&&(null==r.f.name.errors?null:r.f.name.errors.required)),e.R7$(),e.Y8G("ngIf",r.submitted&&(null==r.f.name.errors?null:r.f.name.errors.minlength)),e.R7$(7),e.Y8G("ngIf",r.submitted&&(null==r.f.email.errors?null:r.f.email.errors.required)),e.R7$(),e.Y8G("ngIf",r.submitted&&(null==r.f.email.errors?null:r.f.email.errors.email)),e.R7$(7),e.Y8G("ngIf",r.submitted&&(null==r.f.phone.errors?null:r.f.phone.errors.required)),e.R7$(),e.Y8G("ngIf",r.submitted&&(null==r.f.phone.errors?null:r.f.phone.errors.pattern)),e.R7$(7),e.Y8G("ngIf",r.submitted&&(null==r.f.username.errors?null:r.f.username.errors.required)),e.R7$(),e.Y8G("ngIf",r.submitted&&(null==r.f.username.errors?null:r.f.username.errors.minlength)),e.R7$(19),e.Y8G("ngIf",r.submitted&&(null==r.f.gender.errors?null:r.f.gender.errors.required)),e.R7$(7),e.Y8G("ngIf",r.submitted&&(null==r.f.designation.errors?null:r.f.designation.errors.required)),e.R7$(55),e.Y8G("ngIf",r.submitted&&(null==r.f.emergencyContactPhone.errors?null:r.f.emergencyContactPhone.errors.pattern)),e.R7$(8),e.Y8G("items",r.subjectsList)("multiple",!0)("closeOnSelect",!1)("searchable",!0),e.R7$(),e.Y8G("ngIf",r.submitted&&(null==r.f.subjects.errors?null:r.f.subjects.errors.required)),e.R7$(9),e.Y8G("ngIf",r.fileError),e.R7$(),e.Y8G("ngIf",r.submitted&&!r.selectedFile),e.R7$(),e.Y8G("ngIf",r.imagePreview),e.R7$(),e.Y8G("ngIf",r.loading),e.R7$(6),e.Y8G("ngIf",r.serverError),e.R7$(2),e.Y8G("disabled",r.loading||r.form.invalid||!r.selectedFile),e.R7$(),e.Y8G("ngIf",r.loading),e.R7$(),e.SpI(" ",r.loading?"Adding Teacher...":"Add Teacher"," "))},dependencies:[d.MD,d.bT,n.X1,n.qT,n.xH,n.y7,n.me,n.Q0,n.wz,n.BC,n.cb,n.VZ,n.j4,n.JD,g.i,c.MQ,c.vr],styles:[".form-section[_ngcontent-%COMP%]{border:1px solid #e3e6f0;border-radius:8px;padding:1.5rem;margin-bottom:1.5rem;background:#fafbfe}.form-section[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;font-size:.95rem;font-weight:600;text-transform:uppercase;letter-spacing:.8px;padding:.5rem 1rem;border-radius:6px;width:auto;float:none;margin-bottom:1rem}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#2d3748;font-size:.9rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border:1px solid #cbd5e0}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#667eea;box-shadow:0 0 0 .2rem #667eea40}.text-danger[_ngcontent-%COMP%]{font-size:.8rem}.img-thumbnail[_ngcontent-%COMP%]{border:2px solid #e2e8f0;border-radius:8px}button[disabled][_ngcontent-%COMP%]{opacity:.65;cursor:not-allowed}@media (max-width: 576px){.form-section[_ngcontent-%COMP%]{padding:1rem}legend[_ngcontent-%COMP%]{font-size:.85rem;padding:.4rem .8rem}}"]})}}return t})()}}]);